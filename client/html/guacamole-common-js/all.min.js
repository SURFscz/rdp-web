'use strict';var Guacamole=Guacamole||{};Guacamole.ArrayBufferReader=function(b){var a=this;b.onblob=function(b){b=window.atob(b);for(var c=new ArrayBuffer(b.length),d=new Uint8Array(c),f=0;f<b.length;f++)d[f]=b.charCodeAt(f);if(a.ondata)a.ondata(c)};b.onend=function(){if(a.onend)a.onend()};this.onend=this.ondata=null};Guacamole=Guacamole||{};
Guacamole.ArrayBufferWriter=function(b){function a(a){for(var c="",d=0;d<a.byteLength;d++)c+=String.fromCharCode(a[d]);b.sendBlob(window.btoa(c))}var d=this;b.onack=function(a){if(d.onack)d.onack(a)};this.blobLength=Guacamole.ArrayBufferWriter.DEFAULT_BLOB_LENGTH;this.sendData=function(b){b=new Uint8Array(b);if(b.length<=d.blobLength)a(b);else for(var c=0;c<b.length;c+=d.blobLength)a(b.subarray(c,c+d.blobLength))};this.sendEnd=function(){b.sendEnd()};this.onack=null};
Guacamole.ArrayBufferWriter.DEFAULT_BLOB_LENGTH=6048;Guacamole=Guacamole||{};Guacamole.AudioContextFactory={singleton:null,getAudioContext:function(){var b=window.AudioContext||window.webkitAudioContext;if(b)try{return Guacamole.AudioContextFactory.singleton||(Guacamole.AudioContextFactory.singleton=new b),Guacamole.AudioContextFactory.singleton}catch(a){}return null}};Guacamole=Guacamole||{};Guacamole.AudioPlayer=function(){this.sync=function(){}};Guacamole.AudioPlayer.isSupportedType=function(b){return Guacamole.RawAudioPlayer.isSupportedType(b)};
Guacamole.AudioPlayer.getSupportedTypes=function(){return Guacamole.RawAudioPlayer.getSupportedTypes()};Guacamole.AudioPlayer.getInstance=function(b,a){return Guacamole.RawAudioPlayer.isSupportedType(a)?new Guacamole.RawAudioPlayer(b,a):null};
Guacamole.RawAudioPlayer=function(b,a){var d=Guacamole.RawAudioFormat.parse(a),c=Guacamole.AudioContextFactory.getAudioContext(),e=c.currentTime;b=new Guacamole.ArrayBufferReader(b);var f=1===d.bytesPerSample?window.Int8Array:window.Int16Array,k=1===d.bytesPerSample?128:32768,p=[],h=function(a){if(1>=a.length)return a[0];var b=0;a.forEach(function(a){b+=a.length});var c=0,d=new f(b);a.forEach(function(a){d.set(a,c);c+=a.length});return d};b.ondata=function(a){p.push(new f(new f(a)));if(a=h(p)){var b=
Number.MAX_VALUE,l=a.length,q=Math.floor(.02*d.rate);for(q=Math.max(d.channels*q,d.channels*(Math.floor(a.length/d.channels)-q));q<a.length;q+=d.channels){for(var r=0,m=0;m<d.channels;m++)r+=Math.abs(a[q+m]);r<=b&&(l=q+d.channels,b=r)}p=l===a.length?[a]:[new f(a.buffer.slice(0,l*d.bytesPerSample)),new f(a.buffer.slice(l*d.bytesPerSample))];a=p.shift()}else a=null;if(a){b=c.currentTime;e<b&&(e=b);b=c.createBufferSource();b.connect(c.destination);b.start||(b.start=b.noteOn);l=a;q=l.length/d.channels;
r=c.currentTime;e<r&&(e=r);r=c.createBuffer(d.channels,q,d.rate);for(m=0;m<d.channels;m++)for(var u=r.getChannelData(m),v=m,y=0;y<q;y++)u[y]=l[v]/k,v+=d.channels;b.buffer=r;b.start(e);e+=a.length/d.channels/d.rate}};this.sync=function(){e=Math.min(e,c.currentTime+.3)}};Guacamole.RawAudioPlayer.prototype=new Guacamole.AudioPlayer;Guacamole.RawAudioPlayer.isSupportedType=function(b){return Guacamole.AudioContextFactory.getAudioContext()?null!==Guacamole.RawAudioFormat.parse(b):!1};
Guacamole.RawAudioPlayer.getSupportedTypes=function(){return Guacamole.AudioContextFactory.getAudioContext()?["audio/L8","audio/L16"]:[]};Guacamole=Guacamole||{};Guacamole.AudioRecorder=function(){this.onerror=this.onclose=null};Guacamole.AudioRecorder.isSupportedType=function(b){return Guacamole.RawAudioRecorder.isSupportedType(b)};Guacamole.AudioRecorder.getSupportedTypes=function(){return Guacamole.RawAudioRecorder.getSupportedTypes()};
Guacamole.AudioRecorder.getInstance=function(b,a){return Guacamole.RawAudioRecorder.isSupportedType(a)?new Guacamole.RawAudioRecorder(b,a):null};
Guacamole.RawAudioRecorder=function(b,a){var d=this,c=Guacamole.RawAudioFormat.parse(a),e=Guacamole.AudioContextFactory.getAudioContext();navigator.mediaDevices||(navigator.mediaDevices={});navigator.mediaDevices.getUserMedia||(navigator.mediaDevices.getUserMedia=(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia).bind(navigator));var f=new Guacamole.ArrayBufferWriter(b),k=1===c.bytesPerSample?window.Int8Array:window.Int16Array,p=1===c.bytesPerSample?
128:32768,h=0,m=0,g=null,l=null,q=null,r=function(a){if(0===a)return 1;a*=Math.PI;return Math.sin(a)/a},x=function(a){h+=a.length;var b=Math.round(h*c.rate/a.sampleRate)-m;m+=b;for(var d=new k(b*c.channels),e=0;e<c.channels;e++)for(var f=a.getChannelData(e),g=e,n=0;n<b;n++){for(var w=g,z=f,l=n/(b-1)*(z.length-1),D=Math.floor(l)+3,q=0,x=Math.floor(l)-3+1;x<=D;x++){var u=z[x]||0;var v=l-x;v=-3<v&&3>v?r(v)*r(v/3):0;q+=u*v}d[w]=q*p;g+=c.channels}return d},u=function(a){q=e.createScriptProcessor(2048,
c.channels,c.channels);q.connect(e.destination);q.onaudioprocess=function(a){f.sendData(x(a.inputBuffer).buffer)};l=e.createMediaStreamSource(a);l.connect(q);"suspended"===e.state&&e.resume();g=a},v=function(){f.sendEnd();if(d.onerror)d.onerror()};f.onack=function(a){if(a.code!==Guacamole.Status.Code.SUCCESS||g){l&&l.disconnect();q&&q.disconnect();if(g)for(var b=g.getTracks(),c=0;c<b.length;c++)b[c].stop();g=l=q=null;f.sendEnd();f.onack=null;if(a.code===Guacamole.Status.Code.RESOURCE_CLOSED){if(d.onclose)d.onclose()}else if(d.onerror)d.onerror()}else(a=
navigator.mediaDevices.getUserMedia({audio:!0},u,v))&&a.then&&a.then(u,v)}};Guacamole.RawAudioRecorder.prototype=new Guacamole.AudioRecorder;Guacamole.RawAudioRecorder.isSupportedType=function(b){return Guacamole.AudioContextFactory.getAudioContext()?null!==Guacamole.RawAudioFormat.parse(b):!1};Guacamole.RawAudioRecorder.getSupportedTypes=function(){return Guacamole.AudioContextFactory.getAudioContext()?["audio/L8","audio/L16"]:[]};Guacamole=Guacamole||{};
Guacamole.BlobReader=function(b,a){var d=this,c=0;var e=window.BlobBuilder?new BlobBuilder:window.WebKitBlobBuilder?new WebKitBlobBuilder:window.MozBlobBuilder?new MozBlobBuilder:new function(){var b=[];this.append=function(c){b.push(new Blob([c],{type:a}))};this.getBlob=function(){return new Blob(b,{type:a})}};b.onblob=function(a){a=window.atob(a);for(var f=new ArrayBuffer(a.length),p=new Uint8Array(f),h=0;h<a.length;h++)p[h]=a.charCodeAt(h);e.append(f);c+=f.byteLength;if(d.onprogress)d.onprogress(f.byteLength);
b.sendAck("OK",0)};b.onend=function(){if(d.onend)d.onend()};this.getLength=function(){return c};this.getBlob=function(){return e.getBlob()};this.onend=this.onprogress=null};Guacamole=Guacamole||{};
Guacamole.BlobWriter=function(b){var a=this,d=new Guacamole.ArrayBufferWriter(b);d.onack=function(b){if(a.onack)a.onack(b)};this.sendBlob=function(b){var c=0,f=new FileReader,k=function(){if(c>=b.size){if(a.oncomplete)a.oncomplete(b)}else{a:{var e=c;var h=c+d.blobLength,m=(b.slice||b.webkitSlice||b.mozSlice).bind(b),g=h-e;if(g!==h){var l=m(e,g);if(l.size===g){e=l;break a}}e=m(e,h)}c+=d.blobLength;f.readAsArrayBuffer(e)}};f.onload=function(){d.sendData(f.result);d.onack=function(e){if(a.onack)a.onack(e);
if(!e.isError()){if(a.onprogress)a.onprogress(b,c-d.blobLength);k()}}};f.onerror=function(){if(a.onerror)a.onerror(b,c,f.error)};k()};this.sendEnd=function(){d.sendEnd()};this.oncomplete=this.onprogress=this.onerror=this.onack=null};Guacamole=Guacamole||{};
Guacamole.Client=function(b){function a(n){if(n!=e&&(e=n,c.onstatechange))c.onstatechange(e)}function d(){return e==Guacamole.Client.State.CONNECTED||e==Guacamole.Client.State.WAITING}var c=this,e=Guacamole.Client.State.IDLE,f=0,k=null,p=0,h={0:"butt",1:"round",2:"square"},m={0:"bevel",1:"miter",2:"round"},g=new Guacamole.Display,l={},q={},r=[],x=[],u=[],v=new Guacamole.IntegerPool,y=[];this.exportState=function(n){var a={currentState:e,currentTimestamp:f,layers:{}},b={},c;for(c in l)b[c]=l[c];g.flush(function(){for(var c in b){var w=
parseInt(c),d=b[c],e=d.toCanvas(),f={width:d.width,height:d.height};d.width&&d.height&&(f.url=e.toDataURL("image/png"));if(0<w){f.x=d.x;f.y=d.y;f.z=d.z;f.alpha=d.alpha;f.matrix=d.matrix;w=f;a:{e=void 0;if(d=d.parent)for(e in l)if(d===l[e]){d=parseInt(e);break a}d=null}w.parent=d}a.layers[c]=f}n(a)})};this.importState=function(n,a){var b;e=n.currentState;f=n.currentTimestamp;g.cancel();for(b in l){var c=parseInt(b);0<c&&l[b].dispose()}l={};for(b in n.layers){c=parseInt(b);var d=n.layers[b],w=t(c);
g.resize(w,d.width,d.height);d.url&&(g.setChannelMask(w,Guacamole.Layer.SRC),g.draw(w,0,0,d.url));0<c&&0<=d.parent&&(c=t(d.parent),g.move(w,c,d.x,d.y,d.z),g.shade(w,d.alpha),d=d.matrix,g.distort(w,d[0],d[1],d[2],d[3],d[4],d[5]))}g.flush(a)};this.getDisplay=function(){return g};this.sendSize=function(n,a){d()&&b.sendMessage("size",n,a)};this.sendKeyEvent=function(n,a){d()&&b.sendMessage("key",a,n)};this.sendMouseState=function(n,a){if(d()){var c=n.x,w=n.y;a&&(c/=g.getScale(),w/=g.getScale());g.moveCursor(Math.floor(c),
Math.floor(w));a=0;n.left&&(a|=1);n.middle&&(a|=2);n.right&&(a|=4);n.up&&(a|=8);n.down&&(a|=16);b.sendMessage("mouse",Math.floor(c),Math.floor(w),a)}};this.sendTouchState=function(n,a){if(d()){var c=n.x,w=n.y;a&&(c/=g.getScale(),w/=g.getScale());b.sendMessage("touch",n.id,Math.floor(c),Math.floor(w),Math.floor(n.radiusX),Math.floor(n.radiusY),n.angle,n.force)}};this.createOutputStream=function(){var n=v.next();return y[n]=new Guacamole.OutputStream(c,n)};this.createAudioStream=function(n){var a=c.createOutputStream();
b.sendMessage("audio",a.index,n);return a};this.createFileStream=function(n,a){var d=c.createOutputStream();b.sendMessage("file",d.index,n,a);return d};this.createPipeStream=function(n,a){var d=c.createOutputStream();b.sendMessage("pipe",d.index,n,a);return d};this.createClipboardStream=function(n){var a=c.createOutputStream();b.sendMessage("clipboard",a.index,n);return a};this.createArgumentValueStream=function(n,a){var d=c.createOutputStream();b.sendMessage("argv",d.index,n,a);return d};this.createObjectOutputStream=
function(n,a,d){var w=c.createOutputStream();b.sendMessage("put",n,w.index,a,d);return w};this.requestObjectInputStream=function(a,c){d()&&b.sendMessage("get",a,c)};this.sendAck=function(a,c,e){d()&&b.sendMessage("ack",a,c,e)};this.sendBlob=function(a,c){d()&&b.sendMessage("blob",a,c)};this.endStream=function(a){d()&&(b.sendMessage("end",a),y[a]&&(v.free(a),delete y[a]))};this.onsync=this.onrequired=this.onpipe=this.onfilesystem=this.onfile=this.onclipboard=this.onargv=this.onmultitouch=this.onvideo=
this.onaudio=this.onleave=this.onjoin=this.onmsg=this.onerror=this.onname=this.onstatechange=null;var t=function(a){var n=l[a];n||(n=0===a?g.getDefaultLayer():0<a?g.createLayer():g.createBuffer(),l[a]=n);return n},A={"miter-limit":function(a,b){g.setMiterLimit(a,parseFloat(b))},"multi-touch":function(a,b){if(c.onmultitouch&&a instanceof Guacamole.Display.VisibleLayer)c.onmultitouch(a,parseInt(b))}},E={ack:function(a){var n=parseInt(a[0]),b=a[1];a=parseInt(a[2]);var c=y[n];if(c){if(c.onack)c.onack(new Guacamole.Status(a,
b));256<=a&&y[n]===c&&(v.free(n),delete y[n])}},arc:function(a){var n=t(parseInt(a[0])),b=parseInt(a[1]),c=parseInt(a[2]),d=parseInt(a[3]),e=parseFloat(a[4]),f=parseFloat(a[5]);a=parseInt(a[6]);g.arc(n,b,c,d,e,f,0!=a)},argv:function(a){var n=parseInt(a[0]),b=a[1];a=a[2];c.onargv?(n=x[n]=new Guacamole.InputStream(c,n),c.onargv(n,b,a)):c.sendAck(n,"Receiving argument values unsupported",256)},audio:function(a){var n=parseInt(a[0]);a=a[1];var b=x[n]=new Guacamole.InputStream(c,n),d=null;c.onaudio&&(d=
c.onaudio(b,a));d||(d=Guacamole.AudioPlayer.getInstance(b,a));d?(q[n]=d,c.sendAck(n,"OK",0)):c.sendAck(n,"BAD TYPE",783)},blob:function(a){var n=parseInt(a[0]);a=a[1];if((n=x[n])&&n.onblob)n.onblob(a)},body:function(a){var n=parseInt(a[0]);n=u[n];var b=parseInt(a[1]),d=a[2];a=a[3];n&&n.onbody?(b=x[b]=new Guacamole.InputStream(c,b),n.onbody(b,d,a)):c.sendAck(b,"Receipt of body unsupported",256)},cfill:function(a){var n=parseInt(a[0]),b=t(parseInt(a[1])),c=parseInt(a[2]),d=parseInt(a[3]),e=parseInt(a[4]);
a=parseInt(a[5]);g.setChannelMask(b,n);g.fillColor(b,c,d,e,a)},clip:function(a){a=t(parseInt(a[0]));g.clip(a)},clipboard:function(a){var b=parseInt(a[0]);a=a[1];c.onclipboard?(b=x[b]=new Guacamole.InputStream(c,b),c.onclipboard(b,a)):c.sendAck(b,"Clipboard unsupported",256)},close:function(a){a=t(parseInt(a[0]));g.close(a)},copy:function(a){var b=t(parseInt(a[0])),n=parseInt(a[1]),c=parseInt(a[2]),d=parseInt(a[3]),e=parseInt(a[4]),f=parseInt(a[5]),l=t(parseInt(a[6])),h=parseInt(a[7]);a=parseInt(a[8]);
g.setChannelMask(l,f);g.copy(b,n,c,d,e,l,h,a)},cstroke:function(a){var b=parseInt(a[0]),n=t(parseInt(a[1])),c=h[parseInt(a[2])],d=m[parseInt(a[3])],e=parseInt(a[4]),f=parseInt(a[5]),l=parseInt(a[6]),A=parseInt(a[7]);a=parseInt(a[8]);g.setChannelMask(n,b);g.strokeColor(n,c,d,e,f,l,A,a)},cursor:function(a){var b=parseInt(a[0]),n=parseInt(a[1]),c=t(parseInt(a[2])),d=parseInt(a[3]),e=parseInt(a[4]),f=parseInt(a[5]);a=parseInt(a[6]);g.setCursor(b,n,c,d,e,f,a)},curve:function(a){var b=t(parseInt(a[0])),
n=parseInt(a[1]),c=parseInt(a[2]),d=parseInt(a[3]),e=parseInt(a[4]),f=parseInt(a[5]);a=parseInt(a[6]);g.curveTo(b,n,c,d,e,f,a)},disconnect:function(a){c.disconnect()},dispose:function(a){a=parseInt(a[0]);if(0<a){var b=t(a);g.dispose(b);delete l[a]}else 0>a&&delete l[a]},distort:function(a){var b=parseInt(a[0]),c=parseFloat(a[1]),n=parseFloat(a[2]),d=parseFloat(a[3]),e=parseFloat(a[4]),f=parseFloat(a[5]);a=parseFloat(a[6]);0<=b&&(b=t(b),g.distort(b,c,n,d,e,f,a))},error:function(a){var b=a[0];a=parseInt(a[1]);
if(c.onerror)c.onerror(new Guacamole.Status(a,b));c.disconnect()},end:function(a){a=parseInt(a[0]);var b=x[a];if(b){if(b.onend)b.onend();delete x[a]}},file:function(a){var b=parseInt(a[0]),n=a[1];a=a[2];c.onfile?(b=x[b]=new Guacamole.InputStream(c,b),c.onfile(b,n,a)):c.sendAck(b,"File transfer unsupported",256)},filesystem:function(a){var b=parseInt(a[0]);a=a[1];c.onfilesystem&&(b=u[b]=new Guacamole.Object(c,b),c.onfilesystem(b,a))},identity:function(a){a=t(parseInt(a[0]));g.setTransform(a,1,0,0,
1,0,0)},img:function(a){var b=parseInt(a[0]),n=parseInt(a[1]),d=t(parseInt(a[2])),e=a[3],f=parseInt(a[4]);a=parseInt(a[5]);b=x[b]=new Guacamole.InputStream(c,b);g.setChannelMask(d,n);g.drawStream(d,f,a,b,e)},jpeg:function(a){var b=parseInt(a[0]),c=t(parseInt(a[1])),d=parseInt(a[2]),n=parseInt(a[3]);a=a[4];g.setChannelMask(c,b);g.draw(c,d,n,"data:image/jpeg;base64,"+a)},lfill:function(a){var b=parseInt(a[0]),c=t(parseInt(a[1]));a=t(parseInt(a[2]));g.setChannelMask(c,b);g.fillLayer(c,a)},line:function(a){var b=
t(parseInt(a[0])),c=parseInt(a[1]);a=parseInt(a[2]);g.lineTo(b,c,a)},lstroke:function(a){var b=parseInt(a[0]),c=t(parseInt(a[1]));a=t(parseInt(a[2]));g.setChannelMask(c,b);g.strokeLayer(c,a)},mouse:function(a){var b=parseInt(a[0]);a=parseInt(a[1]);g.showCursor(!0);g.moveCursor(b,a)},move:function(a){var b=parseInt(a[0]),c=parseInt(a[1]),d=parseInt(a[2]),n=parseInt(a[3]);a=parseInt(a[4]);0<b&&0<=c&&(b=t(b),c=t(c),g.move(b,c,d,n,a))},msg:function(a){var b=!0;var d=parseInt(a[0]);c.onmsg&&(b=c.onmsg(d,
a.slice(1)),void 0===b&&(b=!0));if(b)switch(d){case Guacamole.Client.Message.USER_JOINED:b=a[1];a=a[2];if(c.onjoin)c.onjoin(b,a);break;case Guacamole.Client.Message.USER_LEFT:if(b=a[1],a=a[2],c.onleave)c.onleave(b,a)}},name:function(a){if(c.onname)c.onname(a[0])},nest:function(a){var c=parseInt(a[0]),d=r[c];null==d&&(d=r[c]=new Guacamole.Parser,d.oninstruction=b.oninstruction);d.receive(a[1])},pipe:function(a){var b=parseInt(a[0]),d=a[1];a=a[2];c.onpipe?(b=x[b]=new Guacamole.InputStream(c,b),c.onpipe(b,
d,a)):c.sendAck(b,"Named pipes unsupported",256)},png:function(a){var b=parseInt(a[0]),c=t(parseInt(a[1])),d=parseInt(a[2]),n=parseInt(a[3]);a=a[4];g.setChannelMask(c,b);g.draw(c,d,n,"data:image/png;base64,"+a)},pop:function(a){a=t(parseInt(a[0]));g.pop(a)},push:function(a){a=t(parseInt(a[0]));g.push(a)},rect:function(a){var b=t(parseInt(a[0])),c=parseInt(a[1]),d=parseInt(a[2]),e=parseInt(a[3]);a=parseInt(a[4]);g.rect(b,c,d,e,a)},required:function(a){if(c.onrequired)c.onrequired(a)},reset:function(a){a=
t(parseInt(a[0]));g.reset(a)},set:function(a){var b=t(parseInt(a[0])),c=a[2];(a=A[a[1]])&&a(b,c)},shade:function(a){var b=parseInt(a[0]);a=parseInt(a[1]);0<=b&&(b=t(b),g.shade(b,a))},size:function(a){var b=parseInt(a[0]);b=t(b);var c=parseInt(a[1]);a=parseInt(a[2]);g.resize(b,c,a)},start:function(a){var b=t(parseInt(a[0])),c=parseInt(a[1]);a=parseInt(a[2]);g.moveTo(b,c,a)},sync:function(d){var n=parseInt(d[0]);d=d[1]?parseInt(d[1]):0;g.flush(function(){for(var a in q){var c=q[a];c&&c.sync()}n!==f&&
(b.sendMessage("sync",n),f=n)},n,d);e===Guacamole.Client.State.WAITING&&a(Guacamole.Client.State.CONNECTED);if(c.onsync)c.onsync(n,d)},transfer:function(a){var b=t(parseInt(a[0])),c=parseInt(a[1]),d=parseInt(a[2]),e=parseInt(a[3]),f=parseInt(a[4]),n=parseInt(a[5]),l=t(parseInt(a[6])),h=parseInt(a[7]);a=parseInt(a[8]);3===n?g.put(b,c,d,e,f,l,h,a):5!==n&&g.transfer(b,c,d,e,f,l,h,a,Guacamole.Client.DefaultTransferFunction[n])},transform:function(a){var b=t(parseInt(a[0])),c=parseFloat(a[1]),d=parseFloat(a[2]),
e=parseFloat(a[3]),f=parseFloat(a[4]),n=parseFloat(a[5]);a=parseFloat(a[6]);g.transform(b,c,d,e,f,n,a)},undefine:function(a){a=parseInt(a[0]);if((a=u[a])&&a.onundefine)a.onundefine()},video:function(a){var b=parseInt(a[0]),d=t(parseInt(a[1]));a=a[2];var e=x[b]=new Guacamole.InputStream(c,b),f=null;c.onvideo&&(f=c.onvideo(e,d,a));f||(f=Guacamole.VideoPlayer.getInstance(e,d,a));f?c.sendAck(b,"OK",0):c.sendAck(b,"BAD TYPE",783)}},C=function(){b.sendMessage("nop");p=(new Date).getTime()},B=function(){window.clearTimeout(k);
var a=(new Date).getTime();a=Math.max(p+5E3-a,0);0<a?k=window.setTimeout(C,a):C()};b.oninstruction=function(a,b){(a=E[a])&&a(b);B()};this.disconnect=function(){e!=Guacamole.Client.State.DISCONNECTED&&e!=Guacamole.Client.State.DISCONNECTING&&(a(Guacamole.Client.State.DISCONNECTING),window.clearTimeout(k),b.sendMessage("disconnect"),b.disconnect(),a(Guacamole.Client.State.DISCONNECTED))};this.connect=function(c){a(Guacamole.Client.State.CONNECTING);try{b.connect(c)}catch(w){throw a(Guacamole.Client.State.IDLE),
w;}B();a(Guacamole.Client.State.WAITING)}};Guacamole.Client.State={IDLE:0,CONNECTING:1,WAITING:2,CONNECTED:3,DISCONNECTING:4,DISCONNECTED:5};
Guacamole.Client.DefaultTransferFunction={0:function(b,a){a.red=a.green=a.blue=0},15:function(b,a){a.red=a.green=a.blue=255},3:function(b,a){a.red=b.red;a.green=b.green;a.blue=b.blue;a.alpha=b.alpha},5:function(b,a){},12:function(b,a){a.red=255&~b.red;a.green=255&~b.green;a.blue=255&~b.blue;a.alpha=b.alpha},10:function(b,a){a.red=255&~a.red;a.green=255&~a.green;a.blue=255&~a.blue},1:function(b,a){a.red&=b.red;a.green&=b.green;a.blue&=b.blue},14:function(b,a){a.red=255&~(b.red&a.red);a.green=255&~(b.green&
a.green);a.blue=255&~(b.blue&a.blue)},7:function(b,a){a.red|=b.red;a.green|=b.green;a.blue|=b.blue},8:function(b,a){a.red=255&~(b.red|a.red);a.green=255&~(b.green|a.green);a.blue=255&~(b.blue|a.blue)},6:function(b,a){a.red^=b.red;a.green^=b.green;a.blue^=b.blue},9:function(b,a){a.red=255&~(b.red^a.red);a.green=255&~(b.green^a.green);a.blue=255&~(b.blue^a.blue)},4:function(b,a){a.red&=255&~b.red;a.green&=255&~b.green;a.blue&=255&~b.blue},13:function(b,a){a.red=255&(~b.red|a.red);a.green=255&(~b.green|
a.green);a.blue=255&(~b.blue|a.blue)},2:function(b,a){a.red=255&b.red&~a.red;a.green=255&b.green&~a.green;a.blue=255&b.blue&~a.blue},11:function(b,a){a.red=255&(b.red|~a.red);a.green=255&(b.green|~a.green);a.blue=255&(b.blue|~a.blue)}};Guacamole.Client.Message={USER_JOINED:1,USER_LEFT:2};Guacamole=Guacamole||{};Guacamole.DataURIReader=function(b,a){var d=this,c="data:"+a+";base64,";b.onblob=function(a){c+=a};b.onend=function(){if(d.onend)d.onend()};this.getURI=function(){return c};this.onend=null};
Guacamole=Guacamole||{};
Guacamole.Display=function(){function b(){window.requestAnimationFrame&&document.hasFocus()?u():x()}function a(a,c){var d=this;this.blocked=c;this.cancel=function(){d.blocked=!1;a=null};this.unblock=function(){d.blocked&&(d.blocked=!1,b())};this.execute=function(){a&&a()}}function d(b,c){b=new a(b,c);l.push(b);return b}var c=this,e=0,f=0,k=1,p=document.createElement("div");p.style.position="relative";p.style.width=e+"px";p.style.height=f+"px";p.style.transformOrigin=p.style.webkitTransformOrigin=p.style.MozTransformOrigin=
p.style.OTransformOrigin=p.style.msTransformOrigin="0 0";var h=new Guacamole.Display.VisibleLayer(e,f),m=new Guacamole.Display.VisibleLayer(0,0);m.setChannelMask(Guacamole.Layer.SRC);p.appendChild(h.getElement());p.appendChild(m.getElement());var g=document.createElement("div");g.style.position="relative";g.style.width=e*k+"px";g.style.height=f*k+"px";g.appendChild(p);this.statisticWindow=this.cursorY=this.cursorX=this.cursorHotspotY=this.cursorHotspotX=0;this.onstatistics=this.oncursor=this.onresize=
null;var l=[],q=[],r=null,x=function(){for(var a=0,b=0,c=0,d=0;d<q.length;){var e=q[d];if(!e.isReady())break;e.flush();a=e.localTimestamp;b=e.remoteTimestamp;c+=e.logicalFrames;d++}q.splice(0,d);d&&y(a,b,c)},u=function(){var a=function C(){r=null;if(q.length){if(q[0].isReady()){var a=q.shift();a.flush();y(a.localTimestamp,a.remoteTimestamp,a.logicalFrames)}q.length&&(r=window.requestAnimationFrame(C))}};r||(r=window.requestAnimationFrame(a))},v=[],y=function(a,b,d){if(c.statisticWindow){for(var e=
(new Date).getTime(),f=0;f<v.length&&!(e-v[f].timestamp<=c.statisticWindow);f++);v.splice(0,f-1);v.push({localTimestamp:a,remoteTimestamp:b,timestamp:e,frames:d});b=(v[v.length-1].timestamp-v[0].timestamp)/1E3;d=(v[v.length-1].remoteTimestamp-v[0].remoteTimestamp)/1E3;f=v.length;var g=v.reduce(function(a,b){return a+b.frames},0),l=v.reduce(function(a,b){return a+Math.max(0,b.frames-1)},0);a=new Guacamole.Display.Statistics({processingLag:e-a,desktopFps:d&&g?g/d:null,clientFps:b?f/b:null,serverFps:d?
f/d:null,dropRate:d?l/d:null});if(c.onstatistics)c.onstatistics(a)}};window.addEventListener("blur",function(){r&&!document.hasFocus()&&(window.cancelAnimationFrame(r),r=null,x())},!0);var t=function(a,b,c,d){this.localTimestamp=(new Date).getTime();this.remoteTimestamp=c||this.localTimestamp;this.logicalFrames=d||0;this.cancel=function(){a=null;b.forEach(function(a){a.cancel()});b=[]};this.isReady=function(){for(var a=0;a<b.length;a++)if(b[a].blocked)return!1;return!0};this.flush=function(){for(var c=
0;c<b.length;c++)b[c].execute();a&&a()}};this.getElement=function(){return g};this.getWidth=function(){return e};this.getHeight=function(){return f};this.getDefaultLayer=function(){return h};this.getCursorLayer=function(){return m};this.createLayer=function(){var a=new Guacamole.Display.VisibleLayer(e,f);a.move(h,0,0,0);return a};this.createBuffer=function(){var a=new Guacamole.Layer(0,0);a.autosize=1;return a};this.flush=function(a,c,d){q.push(new t(a,l,c,d));l=[];b()};this.cancel=function(){q.forEach(function(a){a.cancel()});
q=[];l.forEach(function(a){a.cancel()});l=[]};this.setCursor=function(a,b,e,f,g,l,h){d(function(){c.cursorHotspotX=a;c.cursorHotspotY=b;m.resize(l,h);m.copy(e,f,g,l,h,0,0);c.moveCursor(c.cursorX,c.cursorY);if(c.oncursor)c.oncursor(m.toCanvas(),a,b)})};this.showCursor=function(a){var b=m.getElement(),c=b.parentNode;!1===a?c&&c.removeChild(b):c!==p&&p.appendChild(b)};this.moveCursor=function(a,b){m.translate(a-c.cursorHotspotX,b-c.cursorHotspotY);c.cursorX=a;c.cursorY=b};this.resize=function(a,b,l){d(function(){a.resize(b,
l);if(a===h&&(e=b,f=l,p.style.width=e+"px",p.style.height=f+"px",g.style.width=e*k+"px",g.style.height=f*k+"px",c.onresize))c.onresize(b,l)})};this.drawImage=function(a,b,c,e){d(function(){a.drawImage(b,c,e)})};this.drawBlob=function(a,b,c,e){if(window.createImageBitmap){var f;var g=d(function(){a.drawImage(b,c,f)},!0);window.createImageBitmap(e).then(function(a){f=a;g.unblock()})}else{var l=URL.createObjectURL(e);g=d(function(){h.width&&h.height&&a.drawImage(b,c,h);URL.revokeObjectURL(l)},!0);var h=
new Image;h.onload=g.unblock;h.onerror=g.unblock;h.src=l}};this.drawStream=function(a,b,d,e,f){if(window.createImageBitmap){var g=new Guacamole.BlobReader(e,f);g.onend=function(){c.drawBlob(a,b,d,g.getBlob())}}else g=new Guacamole.DataURIReader(e,f),g.onend=function(){c.draw(a,b,d,g.getURI())}};this.draw=function(a,b,c,e){var f=d(function(){g.width&&g.height&&a.drawImage(b,c,g)},!0),g=new Image;g.onload=f.unblock;g.onerror=f.unblock;g.src=e};this.play=function(a,b,c,e){var f=document.createElement("video");
f.type=b;f.src=e;f.addEventListener("play",function(){function b(){a.drawImage(0,0,f);f.ended||window.setTimeout(b,20)}b()},!1);d(f.play)};this.transfer=function(a,b,c,e,f,g,l,h,D){d(function(){g.transfer(a,b,c,e,f,l,h,D)})};this.put=function(a,b,c,e,f,g,l,h){d(function(){g.put(a,b,c,e,f,l,h)})};this.copy=function(a,b,c,e,f,g,l,h){d(function(){g.copy(a,b,c,e,f,l,h)})};this.moveTo=function(a,b,c){d(function(){a.moveTo(b,c)})};this.lineTo=function(a,b,c){d(function(){a.lineTo(b,c)})};this.arc=function(a,
b,c,e,f,g,l){d(function(){a.arc(b,c,e,f,g,l)})};this.curveTo=function(a,b,c,e,f,g,l){d(function(){a.curveTo(b,c,e,f,g,l)})};this.close=function(a){d(function(){a.close()})};this.rect=function(a,b,c,e,f){d(function(){a.rect(b,c,e,f)})};this.clip=function(a){d(function(){a.clip()})};this.strokeColor=function(a,b,c,e,f,g,l,h){d(function(){a.strokeColor(b,c,e,f,g,l,h)})};this.fillColor=function(a,b,c,e,f){d(function(){a.fillColor(b,c,e,f)})};this.strokeLayer=function(a,b,c,e,f){d(function(){a.strokeLayer(b,
c,e,f)})};this.fillLayer=function(a,b){d(function(){a.fillLayer(b)})};this.push=function(a){d(function(){a.push()})};this.pop=function(a){d(function(){a.pop()})};this.reset=function(a){d(function(){a.reset()})};this.setTransform=function(a,b,c,e,f,g,l){d(function(){a.setTransform(b,c,e,f,g,l)})};this.transform=function(a,b,c,e,f,g,l){d(function(){a.transform(b,c,e,f,g,l)})};this.setChannelMask=function(a,b){d(function(){a.setChannelMask(b)})};this.setMiterLimit=function(a,b){d(function(){a.setMiterLimit(b)})};
this.dispose=function(a){d(function(){a.dispose()})};this.distort=function(a,b,c,e,f,g,l){d(function(){a.distort(b,c,e,f,g,l)})};this.move=function(a,b,c,e,f){d(function(){a.move(b,c,e,f)})};this.shade=function(a,b){d(function(){a.shade(b)})};this.scale=function(a){p.style.transform=p.style.WebkitTransform=p.style.MozTransform=p.style.OTransform=p.style.msTransform="scale("+a+","+a+")";k=a;g.style.width=e*k+"px";g.style.height=f*k+"px"};this.getScale=function(){return k};this.flatten=function(){function a(a){var b=
[],c;for(c in a.children)b.push(a.children[c]);b.sort(function(a,b){var c=a.z-b.z;if(0!==c)return c;a=a.getElement();b=b.getElement().compareDocumentPosition(a);return b&Node.DOCUMENT_POSITION_PRECEDING?-1:b&Node.DOCUMENT_POSITION_FOLLOWING?1:0});return b}function b(c,e,f){if(0<c.width&&0<c.height){var g=d.globalAlpha;d.globalAlpha*=c.alpha/255;d.drawImage(c.getCanvas(),e,f);c=a(c);for(var l=0;l<c.length;l++){var h=c[l];b(h,e+h.x,f+h.y)}d.globalAlpha=g}}var c=document.createElement("canvas");c.width=
h.width;c.height=h.height;var d=c.getContext("2d");b(h,0,0);return c}};
Guacamole.Display.VisibleLayer=function(b,a){Guacamole.Layer.apply(this,[b,a]);var d=this;this.__unique_id=Guacamole.Display.VisibleLayer.__next_id++;this.alpha=255;this.z=this.y=this.x=0;this.matrix=[1,0,0,1,0,0];this.parent=null;this.children={};var c=d.getCanvas();c.style.position="absolute";c.style.left="0px";c.style.top="0px";var e=document.createElement("div");e.appendChild(c);e.style.width=b+"px";e.style.height=a+"px";e.style.position="absolute";e.style.left="0px";e.style.top="0px";e.style.overflow=
"hidden";var f=this.resize;this.resize=function(a,b){e.style.width=a+"px";e.style.height=b+"px";f(a,b)};this.getElement=function(){return e};var k="translate(0px, 0px)",p="matrix(1, 0, 0, 1, 0, 0)";this.translate=function(a,b){d.x=a;d.y=b;k="translate("+a+"px,"+b+"px)";e.style.transform=e.style.WebkitTransform=e.style.MozTransform=e.style.OTransform=e.style.msTransform=k+" "+p};this.move=function(a,b,c,f){d.parent!==a&&(d.parent&&delete d.parent.children[d.__unique_id],d.parent=a,a.children[d.__unique_id]=
d,a.getElement().appendChild(e));d.translate(b,c);d.z=f;e.style.zIndex=f};this.shade=function(a){d.alpha=a;e.style.opacity=a/255};this.dispose=function(){d.parent&&(delete d.parent.children[d.__unique_id],d.parent=null);e.parentNode&&e.parentNode.removeChild(e)};this.distort=function(a,b,c,f,q,r){d.matrix=[a,b,c,f,q,r];p="matrix("+a+","+b+","+c+","+f+","+q+","+r+")";e.style.transform=e.style.WebkitTransform=e.style.MozTransform=e.style.OTransform=e.style.msTransform=k+" "+p}};
Guacamole.Display.VisibleLayer.__next_id=0;Guacamole.Display.Statistics=function(b){b=b||{};this.processingLag=b.processingLag;this.desktopFps=b.desktopFps;this.serverFps=b.serverFps;this.clientFps=b.clientFps;this.dropRate=b.dropRate};Guacamole=Guacamole||{};Guacamole.Event=function(b){this.type=b;this.timestamp=(new Date).getTime();this.getAge=function(){return(new Date).getTime()-this.timestamp};this.invokeLegacyHandler=function(a){}};
Guacamole.Event.DOMEvent=function(b,a){Guacamole.Event.call(this,b);a=a||[];Array.isArray(a)||(a=[a]);this.preventDefault=function(){a.forEach(function(a){a.preventDefault&&a.preventDefault();a.returnValue=!1})};this.stopPropagation=function(){a.forEach(function(a){a.stopPropagation()})}};Guacamole.Event.DOMEvent.cancelEvent=function(b){b.stopPropagation();b.preventDefault&&b.preventDefault();b.returnValue=!1};
Guacamole.Event.Target=function(){var b={};this.on=function(a,d){var c=b[a];c||(b[a]=c=[]);c.push(d)};this.onEach=function(a,b){a.forEach(function(a){this.on(a,b)},this)};this.dispatch=function(a){a.invokeLegacyHandler(this);var d=b[a.type];if(d)for(var c=0;c<d.length;c++)d[c](a,this)};this.off=function(a,d){a=b[a];if(!a)return!1;for(var c=0;c<a.length;c++)if(a[c]===d)return a.splice(c,1),!0;return!1};this.offEach=function(a,b){var c=!1;a.forEach(function(a){c|=this.off(a,b)},this);return c}};
Guacamole=Guacamole||{};
Guacamole.InputSink=function(){var b=this,a=document.createElement("textarea");a.style.position="fixed";a.style.outline="none";a.style.border="none";a.style.margin="0";a.style.padding="0";a.style.height="0";a.style.width="0";a.style.left="0";a.style.bottom="0";a.style.resize="none";a.style.background="transparent";a.style.color="transparent";a.addEventListener("keypress",function(b){a.value=""},!1);a.addEventListener("compositionend",function(b){b.data&&(a.value="")},!1);a.addEventListener("input",function(b){b.data&&
!b.isComposing&&(a.value="")},!1);a.addEventListener("focus",function(){window.setTimeout(function(){a.click();a.select()},0)},!0);this.focus=function(){window.setTimeout(function(){a.focus()},0)};this.getElement=function(){return a};document.addEventListener("keydown",function(a){if((a=document.activeElement)&&a!==document.body&&(a=a.getBoundingClientRect(),0<a.left+a.width&&0<a.top+a.height))return;b.focus()},!0)};Guacamole=Guacamole||{};
Guacamole.InputStream=function(b,a){var d=this;this.index=a;this.onend=this.onblob=null;this.sendAck=function(a,e){b.sendAck(d.index,a,e)}};Guacamole=Guacamole||{};Guacamole.IntegerPool=function(){var b=this,a=[];this.next_int=0;this.next=function(){return 0<a.length?a.shift():b.next_int++};this.free=function(b){a.push(b)}};Guacamole=Guacamole||{};
Guacamole.JSONReader=function(b){var a=this;b=new Guacamole.StringReader(b);var d="";this.getLength=function(){return d.length};this.getJSON=function(){return JSON.parse(d)};b.ontext=function(b){d+=b;if(a.onprogress)a.onprogress(b.length)};b.onend=function(){if(a.onend)a.onend()};this.onend=this.onprogress=null};Guacamole=Guacamole||{};
Guacamole.Keyboard=function(b){function a(a,b,c){if(!a)return null;var e=a.indexOf("U+");if(0<=e)a=a.substring(e+2),a=String.fromCharCode(parseInt(a,16));else if(1!==a.length||3===b)return B(u[a],b);!0===c?a=a.toUpperCase():!1===c&&(a=a.toLowerCase());c=a.charCodeAt(0);return d(c)}function d(a){return 31>=a||127<=a&&159>=a?65280|a:0<=a&&255>=a?a:256<=a&&1114111>=a?16777216|a:null}function c(){var a=z();if(!a)return!1;do{var b=a;a=z()}while(null!==a);a:{for(var c in e.pressed)if(!y[c]){a=!1;break a}a=
!0}a&&e.reset();return b.defaultPrevented}var e=this,f="_GUAC_KEYBOARD_HANDLED_BY_"+Guacamole.Keyboard._nextID++;this.onkeyup=this.onkeydown=null;var k=!1,p=!1,h=!1;navigator&&navigator.platform&&(navigator.platform.match(/ipad|iphone|ipod/i)?k=!0:navigator.platform.match(/^mac/i)&&(h=p=!0));var m=function(a){var b=this;this.keyCode=a?a.which||a.keyCode:0;this.keyIdentifier=a&&a.keyIdentifier;this.key=a&&a.key;var c=a?"location"in a?a.location:"keyLocation"in a?a.keyLocation:0:0;this.location=c;this.modifiers=
a?Guacamole.Keyboard.ModifierState.fromKeyboardEvent(a):new Guacamole.Keyboard.ModifierState;this.timestamp=(new Date).getTime();this.defaultPrevented=!1;this.keysym=null;this.reliable=!1;this.getAge=function(){return(new Date).getTime()-b.timestamp}},g=function(b){m.call(this,b);this.keysym=a(this.key,this.location)||B(x[this.keyCode],this.location);this.keyupReliable=!k;if(b=this.keysym)b=this.keysym,b=!(0<=b&&255>=b||16777216===(b&4294901760));b&&(this.reliable=!0);if(b=!this.keysym){b=this.keyCode;
var c=this.keyIdentifier;if(c){var d=c.indexOf("U+");-1===d?b=!0:(c=parseInt(c.substring(d+2),16),b=b!==c||65<=b&&90>=b||48<=b&&57>=b?!0:!1)}else b=!1}b&&(this.keysym=a(this.keyIdentifier,this.location,this.modifiers.shift));this.modifiers.meta&&65511!==this.keysym&&65512!==this.keysym?this.keyupReliable=!1:65509===this.keysym&&h&&(this.keyupReliable=!1);b=!this.modifiers.ctrl&&!p;!p||65513!==this.keysym&&65514!==this.keysym||(this.keysym=65027);if(!this.modifiers.alt&&this.modifiers.ctrl||b&&this.modifiers.alt||
this.modifiers.meta||this.modifiers.hyper)this.reliable=!0;A[this.keyCode]=this.keysym};g.prototype=new m;var l=function(a){m.call(this,a);this.keysym=d(this.keyCode);this.reliable=!0};l.prototype=new m;var q=function(b){m.call(this,b);this.keysym=B(x[this.keyCode],this.location)||a(this.key,this.location);e.pressed[this.keysym]||(this.keysym=A[this.keyCode]||this.keysym);this.reliable=!0};q.prototype=new m;var r=[],x={8:[65288],9:[65289],12:[65291,65291,65291,65461],13:[65293],16:[65505,65505,65506],
17:[65507,65507,65508],18:[65513,65513,65514],19:[65299],20:[65509],27:[65307],32:[32],33:[65365,65365,65365,65465],34:[65366,65366,65366,65459],35:[65367,65367,65367,65457],36:[65360,65360,65360,65463],37:[65361,65361,65361,65460],38:[65362,65362,65362,65464],39:[65363,65363,65363,65462],40:[65364,65364,65364,65458],45:[65379,65379,65379,65456],46:[65535,65535,65535,65454],91:[65511],92:[65512],93:[65383],96:[65456],97:[65457],98:[65458],99:[65459],100:[65460],101:[65461],102:[65462],103:[65463],
104:[65464],105:[65465],106:[65450],107:[65451],109:[65453],110:[65454],111:[65455],112:[65470],113:[65471],114:[65472],115:[65473],116:[65474],117:[65475],118:[65476],119:[65477],120:[65478],121:[65479],122:[65480],123:[65481],144:[65407],145:[65300],225:[65027]},u={Again:[65382],AllCandidates:[65341],Alphanumeric:[65328],Alt:[65513,65513,65514],Attn:[64782],AltGraph:[65027],ArrowDown:[65364],ArrowLeft:[65361],ArrowRight:[65363],ArrowUp:[65362],Backspace:[65288],CapsLock:[65509],Cancel:[65385],Clear:[65291],
Convert:[65313],Copy:[64789],Crsel:[64796],CrSel:[64796],CodeInput:[65335],Compose:[65312],Control:[65507,65507,65508],ContextMenu:[65383],Delete:[65535],Down:[65364],End:[65367],Enter:[65293],EraseEof:[64774],Escape:[65307],Execute:[65378],Exsel:[64797],ExSel:[64797],F1:[65470],F2:[65471],F3:[65472],F4:[65473],F5:[65474],F6:[65475],F7:[65476],F8:[65477],F9:[65478],F10:[65479],F11:[65480],F12:[65481],F13:[65482],F14:[65483],F15:[65484],F16:[65485],F17:[65486],F18:[65487],F19:[65488],F20:[65489],F21:[65490],
F22:[65491],F23:[65492],F24:[65493],Find:[65384],GroupFirst:[65036],GroupLast:[65038],GroupNext:[65032],GroupPrevious:[65034],FullWidth:null,HalfWidth:null,HangulMode:[65329],Hankaku:[65321],HanjaMode:[65332],Help:[65386],Hiragana:[65317],HiraganaKatakana:[65319],Home:[65360],Hyper:[65517,65517,65518],Insert:[65379],JapaneseHiragana:[65317],JapaneseKatakana:[65318],JapaneseRomaji:[65316],JunjaMode:[65336],KanaMode:[65325],KanjiMode:[65313],Katakana:[65318],Left:[65361],Meta:[65511,65511,65512],ModeChange:[65406],
NumLock:[65407],PageDown:[65366],PageUp:[65365],Pause:[65299],Play:[64790],PreviousCandidate:[65342],PrintScreen:[65377],Redo:[65382],Right:[65363],RomanCharacters:null,Scroll:[65300],Select:[65376],Separator:[65452],Shift:[65505,65505,65506],SingleCandidate:[65340],Super:[65515,65515,65516],Tab:[65289],UIKeyInputDownArrow:[65364],UIKeyInputEscape:[65307],UIKeyInputLeftArrow:[65361],UIKeyInputRightArrow:[65363],UIKeyInputUpArrow:[65362],Up:[65362],Undo:[65381],Win:[65511,65511,65512],Zenkaku:[65320],
ZenkakuHankaku:[65322]},v={65027:!0,65505:!0,65506:!0,65507:!0,65508:!0,65509:!0,65511:!0,65512:!0,65513:!0,65514:!0,65515:!0,65516:!0};this.modifiers=new Guacamole.Keyboard.ModifierState;this.pressed={};var y={},t={},A={},E=null,C=null,B=function(a,b){return a?a[b]||a[0]:null};this.press=function(a){if(null!==a){if(!e.pressed[a]&&(e.pressed[a]=!0,e.onkeydown)){var b=e.onkeydown(a);t[a]=b;window.clearTimeout(E);window.clearInterval(C);v[a]||(E=window.setTimeout(function(){C=window.setInterval(function(){e.onkeyup(a);
e.onkeydown(a)},50)},500));return b}return t[a]||!1}};this.release=function(a){if(e.pressed[a]&&(delete e.pressed[a],delete y[a],window.clearTimeout(E),window.clearInterval(C),null!==a&&e.onkeyup))e.onkeyup(a)};this.type=function(a){for(var b=0;b<a.length;b++){var c=a.codePointAt?a.codePointAt(b):a.charCodeAt(b);c=d(c);e.press(c);e.release(c)}};this.reset=function(){for(var a in e.pressed)e.release(parseInt(a));r=[]};var n=function(a,b,c){var d=c.modifiers[a];a=e.modifiers[a];if(-1===b.indexOf(c.keysym))if(a&&
!1===d)for(d=0;d<b.length;d++)e.release(b[d]);else if(!a&&d){for(d=0;d<b.length;d++)if(e.pressed[b[d]])return;b=b[0];c.keysym&&(y[b]=!0);e.press(b)}},w=function(a){n("alt",[65513,65514,65027],a);n("shift",[65505,65506],a);n("ctrl",[65507,65508],a);n("meta",[65511,65512],a);n("hyper",[65515,65516],a);e.modifiers=a.modifiers},z=function(){var a=r[0];if(!a)return null;if(a instanceof g){var b=null,c=[];if(65511===a.keysym||65512===a.keysym){if(1===r.length)return null;if(r[1].keysym!==a.keysym){if(!r[1].modifiers.meta)return r.shift()}else if(r[1]instanceof
g)return r.shift()}a.reliable?(b=a.keysym,c=r.splice(0,1)):r[1]instanceof l?(b=r[1].keysym,c=r.splice(0,2)):r[1]&&(b=a.keysym,c=r.splice(0,1));if(0<c.length){w(a);if(b){e.modifiers.ctrl&&e.modifiers.alt&&!(65<=b&&90>=b||97<=b&&122>=b)&&(255>=b||16777216===(b&4278190080))&&(e.release(65507),e.release(65508),e.release(65513),e.release(65514));var d=!e.press(b);A[a.keyCode]=b;a.keyupReliable||e.release(b);for(b=0;b<c.length;b++)c[b].defaultPrevented=d}return a}}else{if(a instanceof q&&!k){if(b=a.keysym)e.release(b),
delete A[a.keyCode],a.defaultPrevented=!0;else return e.reset(),a;w(a)}return r.shift()}return null},F=function(a){return a[f]?!1:a[f]=!0};this.listenTo=function(a){a.addEventListener("keydown",function(a){if(e.onkeydown&&F(a)){var b=new g(a);a.isComposing||229===b.keyCode||(r.push(b),c()&&a.preventDefault())}},!0);a.addEventListener("keypress",function(a){(e.onkeydown||e.onkeyup)&&F(a)&&(r.push(new l(a)),c()&&a.preventDefault())},!0);a.addEventListener("keyup",function(a){e.onkeyup&&F(a)&&(a.preventDefault(),
r.push(new q(a)),c())},!0);var b=function(a){(e.onkeydown||e.onkeyup)&&F(a)&&a.data&&!a.isComposing&&e.type(a.data)};a.addEventListener("input",b,!1);a.addEventListener("compositionend",function(a){(e.onkeydown||e.onkeyup)&&F(a)&&a.data&&e.type(a.data)},!1);a.addEventListener("compositionstart",function(c){a.removeEventListener("input",b,!1)},!1)};b&&e.listenTo(b)};Guacamole.Keyboard._nextID=0;Guacamole.Keyboard.ModifierState=function(){this.hyper=this.meta=this.alt=this.ctrl=this.shift=!1};
Guacamole.Keyboard.ModifierState.fromKeyboardEvent=function(b){var a=new Guacamole.Keyboard.ModifierState;a.shift=b.shiftKey;a.ctrl=b.ctrlKey;a.alt=b.altKey;a.meta=b.metaKey;b.getModifierState&&(a.hyper=b.getModifierState("OS")||b.getModifierState("Super")||b.getModifierState("Hyper")||b.getModifierState("Win"));return a};Guacamole=Guacamole||{};
Guacamole.KeyEventInterpreter=function(b,a){var d=this;if(void 0===b||null===b)b=5E3;if(void 0===a||null===a)a=0;var c=function(a){this.keysym=parseInt(a.keysym);this.name=a.name;this.value=a.value;this.modifier=a.modifier||!1},e={};[{keysym:65027,name:"AltGr",value:"",modifier:!0},{keysym:65288,name:"Backspace"},{keysym:65289,name:"Tab"},{keysym:65291,name:"Clear"},{keysym:65293,name:"Return",value:"\n"},{keysym:65299,name:"Pause"},{keysym:65300,name:"Scroll"},{keysym:65301,name:"SysReq"},{keysym:65307,
name:"Escape"},{keysym:65360,name:"Home"},{keysym:65361,name:"Left"},{keysym:65362,name:"Up"},{keysym:65363,name:"Right"},{keysym:65364,name:"Down"},{keysym:65365,name:"Page Up"},{keysym:65366,name:"Page Down"},{keysym:65367,name:"End"},{keysym:65379,name:"Insert"},{keysym:65381,name:"Undo"},{keysym:65386,name:"Help"},{keysym:65407,name:"Num"},{keysym:65408,name:"Space",value:" "},{keysym:65421,name:"Enter",value:"\n"},{keysym:65429,name:"Home"},{keysym:65430,name:"Left"},{keysym:65431,name:"Up"},
{keysym:65432,name:"Right"},{keysym:65433,name:"Down"},{keysym:65434,name:"Page Up"},{keysym:65435,name:"Page Down"},{keysym:65436,name:"End"},{keysym:65438,name:"Insert"},{keysym:65450,name:"*",value:"*"},{keysym:65451,name:"+",value:"+"},{keysym:65453,name:"-",value:"-"},{keysym:65454,name:".",value:"."},{keysym:65455,name:"/",value:"/"},{keysym:65456,name:"0",value:"0"},{keysym:65457,name:"1",value:"1"},{keysym:65458,name:"2",value:"2"},{keysym:65459,name:"3",value:"3"},{keysym:65460,name:"4",
value:"4"},{keysym:65461,name:"5",value:"5"},{keysym:65462,name:"6",value:"6"},{keysym:65463,name:"7",value:"7"},{keysym:65464,name:"8",value:"8"},{keysym:65465,name:"9",value:"9"},{keysym:65470,name:"F1"},{keysym:65471,name:"F2"},{keysym:65472,name:"F3"},{keysym:65473,name:"F4"},{keysym:65474,name:"F5"},{keysym:65475,name:"F6"},{keysym:65476,name:"F7"},{keysym:65477,name:"F8"},{keysym:65478,name:"F9"},{keysym:65479,name:"F10"},{keysym:65480,name:"F11"},{keysym:65481,name:"F12"},{keysym:65482,name:"F13"},
{keysym:65483,name:"F14"},{keysym:65484,name:"F15"},{keysym:65485,name:"F16"},{keysym:65486,name:"F17"},{keysym:65487,name:"F18"},{keysym:65488,name:"F19"},{keysym:65489,name:"F20"},{keysym:65490,name:"F21"},{keysym:65491,name:"F22"},{keysym:65492,name:"F23"},{keysym:65493,name:"F24"},{keysym:65505,name:"Shift",value:"",modifier:!0},{keysym:65506,name:"Shift",value:"",modifier:!0},{keysym:65507,name:"Ctrl",value:null,modifier:!0},{keysym:65508,name:"Ctrl",value:null,modifier:!0},{keysym:65509,name:"Caps"},
{keysym:65511,name:"Meta",value:null,modifier:!0},{keysym:65512,name:"Meta",value:null,modifier:!0},{keysym:65513,name:"Alt",value:null,modifier:!0},{keysym:65514,name:"Alt",value:null,modifier:!0},{keysym:65515,name:"Super",value:null,modifier:!0},{keysym:65516,name:"Super",value:null,modifier:!0},{keysym:65517,name:"Hyper",value:null,modifier:!0},{keysym:65518,name:"Hyper",value:null,modifier:!0},{keysym:65535,name:"Delete"}].forEach(function(a){e[a.keysym]=new c(a)});var f={},k=null,p=0;this.onbatch=
null;this.handleKeyEvent=function(h){var m=parseInt(h[0]),g=parseInt(h[1]),l=parseInt(h[2]);k||(k=new Guacamole.KeyEventInterpreter.KeyEventBatch);h=0<=b&&l-p>=b;p=l;if(h){if(k.events.length&&d.onbatch)d.onbatch(k);k=new Guacamole.KeyEventInterpreter.KeyEventBatch}h=m;if(h in e)h=e[h];else{if(0>h||255<h&&16842751!=(h|65535))var q=null;else q=String.fromCharCode(h&65535),q=new c({keysym:h,name:q,value:q,modifier:!1});h=null!=q?q:new c({keysym:h,name:"0x"+String(h.toString(16))})}if(h.modifier)g?f[m]=
h:delete f[m];else if(g){g=l-a;a:{for(r in f)if(null===f[r].value){var r=!0;break a}r=!1}if(r){r="\x3c";l=!0;for(m in f)q=f[m],l?(r+=q.name,l=!1):r+="+"+q.name;r+="+"+h.name+"\x3e";k.simpleValue+=r;k.events.push(new Guacamole.KeyEventInterpreter.KeyEvent(r,!1,g))}else null!=h.value?(m=h.value,r=!0):(m="\x3c"+h.name+"\x3e",r=!1),k.simpleValue+=m,k.events.push(new Guacamole.KeyEventInterpreter.KeyEvent(m,r,g))}};this.getCurrentBatch=function(){return k}};
Guacamole.KeyEventInterpreter.KeyEvent=function(b,a,d){this.text=b;this.typed=a;this.timestamp=d};Guacamole.KeyEventInterpreter.KeyEventBatch=function(b,a){this.events=b||[];this.simpleValue=a||""};Guacamole=Guacamole||{};
Guacamole.Layer=function(b,a){function d(a,b,d,e){a=d+a;b=e+b;c.resize(a>c.width?a:c.width,b>c.height?b:c.height)}var c=this,e=document.createElement("canvas"),f=e.getContext("2d");f.save();var k=!0,p=!0,h=0,m={1:"destination-in",2:"destination-out",4:"source-in",6:"source-atop",8:"source-out",9:"destination-atop",10:"xor",11:"destination-over",12:"copy",14:"source-over",15:"lighter"},g=function(a,b){a=a||0;b=b||0;var d=64*Math.ceil(a/64),g=64*Math.ceil(b/64);if(e.width!==d||e.height!==g){var l=null;
k||0===e.width||0===e.height||(l=document.createElement("canvas"),l.width=Math.min(c.width,a),l.height=Math.min(c.height,b),l.getContext("2d").drawImage(e,0,0,l.width,l.height,0,0,l.width,l.height));var q=f.globalCompositeOperation;e.width=d;e.height=g;l&&f.drawImage(l,0,0,l.width,l.height,0,0,l.width,l.height);f.globalCompositeOperation=q;h=0;f.save()}else c.reset();c.width=a;c.height=b};this.autosize=!1;this.width=b;this.height=a;this.getCanvas=function(){return e};this.toCanvas=function(){var a=
document.createElement("canvas");a.width=c.width;a.height=c.height;a.getContext("2d").drawImage(c.getCanvas(),0,0);return a};this.resize=function(a,b){a===c.width&&b===c.height||g(a,b)};this.drawImage=function(a,b,e){c.autosize&&d(a,b,e.width,e.height);f.drawImage(e,a,b);k=!1};this.transfer=function(a,b,e,g,h,p,m,t){var l=a.getCanvas();if(!(b>=l.width||e>=l.height)&&(b+g>l.width&&(g=l.width-b),e+h>l.height&&(h=l.height-e),0!==g&&0!==h)){c.autosize&&d(p,m,g,h);a=a.getCanvas().getContext("2d").getImageData(b,
e,g,h);b=f.getImageData(p,m,g,h);for(e=0;e<g*h*4;e+=4){l=new Guacamole.Layer.Pixel(a.data[e],a.data[e+1],a.data[e+2],a.data[e+3]);var q=new Guacamole.Layer.Pixel(b.data[e],b.data[e+1],b.data[e+2],b.data[e+3]);t(l,q);b.data[e]=q.red;b.data[e+1]=q.green;b.data[e+2]=q.blue;b.data[e+3]=q.alpha}f.putImageData(b,p,m);k=!1}};this.put=function(a,b,e,g,h,p,m){var l=a.getCanvas();b>=l.width||e>=l.height||(b+g>l.width&&(g=l.width-b),e+h>l.height&&(h=l.height-e),0!==g&&0!==h&&(c.autosize&&d(p,m,g,h),a=a.getCanvas().getContext("2d").getImageData(b,
e,g,h),f.putImageData(a,p,m),k=!1))};this.copy=function(a,b,e,g,h,p,m){a=a.getCanvas();b>=a.width||e>=a.height||(b+g>a.width&&(g=a.width-b),e+h>a.height&&(h=a.height-e),0!==g&&0!==h&&(c.autosize&&d(p,m,g,h),f.drawImage(a,b,e,g,h,p,m,g,h),k=!1))};this.moveTo=function(a,b){p&&(f.beginPath(),p=!1);c.autosize&&d(a,b,0,0);f.moveTo(a,b)};this.lineTo=function(a,b){p&&(f.beginPath(),p=!1);c.autosize&&d(a,b,0,0);f.lineTo(a,b)};this.arc=function(a,b,e,g,h,m){p&&(f.beginPath(),p=!1);c.autosize&&d(a,b,0,0);f.arc(a,
b,e,g,h,m)};this.curveTo=function(a,b,e,g,h,m){p&&(f.beginPath(),p=!1);c.autosize&&d(h,m,0,0);f.bezierCurveTo(a,b,e,g,h,m)};this.close=function(){f.closePath();p=!0};this.rect=function(a,b,e,g){p&&(f.beginPath(),p=!1);c.autosize&&d(a,b,e,g);f.rect(a,b,e,g)};this.clip=function(){f.clip();p=!0};this.strokeColor=function(a,b,c,d,e,g,h){f.lineCap=a;f.lineJoin=b;f.lineWidth=c;f.strokeStyle="rgba("+d+","+e+","+g+","+h/255+")";f.stroke();k=!1;p=!0};this.fillColor=function(a,b,c,d){f.fillStyle="rgba("+a+
","+b+","+c+","+d/255+")";f.fill();k=!1;p=!0};this.strokeLayer=function(a,b,c,d){f.lineCap=a;f.lineJoin=b;f.lineWidth=c;f.strokeStyle=f.createPattern(d.getCanvas(),"repeat");f.stroke();k=!1;p=!0};this.fillLayer=function(a){f.fillStyle=f.createPattern(a.getCanvas(),"repeat");f.fill();k=!1;p=!0};this.push=function(){f.save();h++};this.pop=function(){0<h&&(f.restore(),h--)};this.reset=function(){for(;0<h;)f.restore(),h--;f.restore();f.save();f.beginPath();p=!1};this.setTransform=function(a,b,c,d,e,g){f.setTransform(a,
b,c,d,e,g)};this.transform=function(a,b,c,d,e,g){f.transform(a,b,c,d,e,g)};this.setChannelMask=function(a){f.globalCompositeOperation=m[a]};this.setMiterLimit=function(a){f.miterLimit=a};g(b,a);e.style.zIndex=-1};Guacamole.Layer.ROUT=2;Guacamole.Layer.ATOP=6;Guacamole.Layer.XOR=10;Guacamole.Layer.ROVER=11;Guacamole.Layer.OVER=14;Guacamole.Layer.PLUS=15;Guacamole.Layer.RIN=1;Guacamole.Layer.IN=4;Guacamole.Layer.OUT=8;Guacamole.Layer.RATOP=9;Guacamole.Layer.SRC=12;
Guacamole.Layer.Pixel=function(b,a,d,c){this.red=b;this.green=a;this.blue=d;this.alpha=c};Guacamole=Guacamole||{};
Guacamole.Mouse=function(b){function a(){f=c.touchMouseThreshold}function d(a){var b=a.deltaY||-a.wheelDeltaY||-a.wheelDelta;b?1===a.deltaMode?b=a.deltaY*c.PIXELS_PER_LINE:2===a.deltaMode&&(b=a.deltaY*c.PIXELS_PER_PAGE):b=a.detail*c.PIXELS_PER_LINE;k+=b;if(k<=-c.scrollThreshold){do c.click(Guacamole.Mouse.State.Buttons.UP),k+=c.scrollThreshold;while(k<=-c.scrollThreshold);k=0}if(k>=c.scrollThreshold){do c.click(Guacamole.Mouse.State.Buttons.DOWN),k-=c.scrollThreshold;while(k>=c.scrollThreshold);k=
0}Guacamole.Event.DOMEvent.cancelEvent(a)}Guacamole.Mouse.Event.Target.call(this);var c=this;this.touchMouseThreshold=3;this.scrollThreshold=53;this.PIXELS_PER_LINE=18;this.PIXELS_PER_PAGE=16*this.PIXELS_PER_LINE;var e=[Guacamole.Mouse.State.Buttons.LEFT,Guacamole.Mouse.State.Buttons.MIDDLE,Guacamole.Mouse.State.Buttons.RIGHT],f=0,k=0;b.addEventListener("contextmenu",function(a){Guacamole.Event.DOMEvent.cancelEvent(a)},!1);b.addEventListener("mousemove",function(a){f?(Guacamole.Event.DOMEvent.cancelEvent(a),
f--):c.move(Guacamole.Position.fromClientPosition(b,a.clientX,a.clientY),a)},!1);b.addEventListener("mousedown",function(a){if(f)Guacamole.Event.DOMEvent.cancelEvent(a);else{var b=e[a.button];b&&c.press(b,a)}},!1);b.addEventListener("mouseup",function(a){if(f)Guacamole.Event.DOMEvent.cancelEvent(a);else{var b=e[a.button];b&&c.release(b,a)}},!1);b.addEventListener("mouseout",function(a){a||(a=window.event);for(var d=a.relatedTarget||a.toElement;d;){if(d===b)return;d=d.parentNode}c.reset(a);c.out(a)},
!1);b.addEventListener("selectstart",function(a){Guacamole.Event.DOMEvent.cancelEvent(a)},!1);b.addEventListener("touchmove",a,!1);b.addEventListener("touchstart",a,!1);b.addEventListener("touchend",a,!1);b.addEventListener("DOMMouseScroll",d,!1);b.addEventListener("mousewheel",d,!1);b.addEventListener("wheel",d,!1);var p=function(){var a=document.createElement("div");if(!("cursor"in a.style))return!1;try{a.style.cursor="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX///+nxBvIAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg\x3d\x3d) 0 0, auto"}catch(m){return!1}return/\burl\([^()]*\)\s+0\s+0\b/.test(a.style.cursor||
"")}();this.setCursor=function(a,c,d){return p?(a=a.toDataURL("image/png"),b.style.cursor="url("+a+") "+c+" "+d+", auto",!0):!1}};Guacamole.Mouse.State=function(b){var a=function(a,b,e,f,k,p,h){return{x:a,y:b,left:e,middle:f,right:k,up:p,down:h}};b=1<arguments.length?a.apply(this,arguments):b||{};Guacamole.Position.call(this,b);this.left=b.left||!1;this.middle=b.middle||!1;this.right=b.right||!1;this.up=b.up||!1;this.down=b.down||!1};
Guacamole.Mouse.State.Buttons={LEFT:"left",MIDDLE:"middle",RIGHT:"right",UP:"up",DOWN:"down"};Guacamole.Mouse.Event=function(b,a,d){Guacamole.Event.DOMEvent.call(this,b,d);var c="on"+this.type;this.state=a;this.invokeLegacyHandler=function(a){a[c]&&(this.preventDefault(),this.stopPropagation(),a[c](this.state))}};
Guacamole.Mouse.Event.Target=function(){Guacamole.Event.Target.call(this);this.currentState=new Guacamole.Mouse.State;this.press=function(b,a){this.currentState[b]||(this.currentState[b]=!0,this.dispatch(new Guacamole.Mouse.Event("mousedown",this.currentState,a)))};this.release=function(b,a){this.currentState[b]&&(this.currentState[b]=!1,this.dispatch(new Guacamole.Mouse.Event("mouseup",this.currentState,a)))};this.click=function(b,a){this.press(b,a);this.release(b,a)};this.move=function(b,a){if(this.currentState.x!==
b.x||this.currentState.y!==b.y)this.currentState.x=b.x,this.currentState.y=b.y,this.dispatch(new Guacamole.Mouse.Event("mousemove",this.currentState,a))};this.out=function(b){this.dispatch(new Guacamole.Mouse.Event("mouseout",this.currentState,b))};this.reset=function(b){for(var a in Guacamole.Mouse.State.Buttons)this.release(Guacamole.Mouse.State.Buttons[a],b)}};
Guacamole.Mouse.Touchpad=function(b){Guacamole.Mouse.Event.Target.call(this);var a=this;this.scrollThreshold=20*(window.devicePixelRatio||1);this.clickTimingThreshold=250;this.clickMoveThreshold=10*(window.devicePixelRatio||1);this.currentState=new Guacamole.Mouse.State;var d=0,c=0,e=0,f=0,k=0,p={1:"left",2:"right",3:"middle"},h=!1,m=null;b.addEventListener("touchend",function(b){b.preventDefault();if(h&&0===b.touches.length){var c=(new Date).getTime(),e=p[d];a.currentState[e]&&(a.release(e,b),m&&
(window.clearTimeout(m),m=null));c-f<=a.clickTimingThreshold&&k<a.clickMoveThreshold&&(a.press(e,b),m=window.setTimeout(function(){a.release(e,b);h=!1},a.clickTimingThreshold));m||(h=!1)}},!1);b.addEventListener("touchstart",function(a){a.preventDefault();d=Math.min(a.touches.length,3);m&&(window.clearTimeout(m),m=null);h||(h=!0,a=a.touches[0],c=a.clientX,e=a.clientY,f=(new Date).getTime(),k=0)},!1);b.addEventListener("touchmove",function(g){g.preventDefault();var l=g.touches[0],h=l.clientX-c,p=l.clientY-
e;k+=Math.abs(h)+Math.abs(p);if(1===d){var m=1+k/((new Date).getTime()-f),u=new Guacamole.Position(a.currentState);u.x+=h*m;u.y+=p*m;u.x=Math.min(Math.max(0,u.x),b.offsetWidth-1);u.y=Math.min(Math.max(0,u.y),b.offsetHeight-1);a.move(u,g);c=l.clientX;e=l.clientY}else 2===d&&Math.abs(p)>=a.scrollThreshold&&(a.click(0<p?"down":"up",g),c=l.clientX,e=l.clientY)},!1)};
Guacamole.Mouse.Touchscreen=function(b){function a(a){var b=a.touches[0]||a.changedTouches[0];a=b.clientX-k;b=b.clientY-p;return Math.sqrt(a*a+b*b)>=e.clickMoveThreshold}function d(a){a=a.touches[0];f=!0;k=a.clientX;p=a.clientY}function c(){window.clearTimeout(h);window.clearTimeout(m);f=!1}Guacamole.Mouse.Event.Target.call(this);var e=this,f=!1,k=null,p=null,h=null,m=null;this.scrollThreshold=20*(window.devicePixelRatio||1);this.clickTimingThreshold=250;this.clickMoveThreshold=16*(window.devicePixelRatio||
1);this.longPressThreshold=500;b.addEventListener("touchend",function(d){if(f)if(0!==d.touches.length||1!==d.changedTouches.length)c();else if(window.clearTimeout(m),e.release(Guacamole.Mouse.State.Buttons.LEFT,d),!a(d)&&(d.preventDefault(),!e.currentState.left)){var g=d.changedTouches[0];e.move(Guacamole.Position.fromClientPosition(b,g.clientX,g.clientY));e.press(Guacamole.Mouse.State.Buttons.LEFT,d);h=window.setTimeout(function(){e.release(Guacamole.Mouse.State.Buttons.LEFT,d);c()},e.clickTimingThreshold)}},
!1);b.addEventListener("touchstart",function(a){1!==a.touches.length?c():(a.preventDefault(),d(a),window.clearTimeout(h),m=window.setTimeout(function(){var d=a.touches[0];e.move(Guacamole.Position.fromClientPosition(b,d.clientX,d.clientY));e.click(Guacamole.Mouse.State.Buttons.RIGHT,a);c()},e.longPressThreshold))},!1);b.addEventListener("touchmove",function(d){if(f)if(a(d)&&window.clearTimeout(m),1!==d.touches.length)c();else if(e.currentState.left){d.preventDefault();var g=d.touches[0];e.move(Guacamole.Position.fromClientPosition(b,
g.clientX,g.clientY),d)}},!1)};Guacamole=Guacamole=Guacamole||{};Guacamole.Object=function(b,a){var d=this,c={};this.index=a;this.onbody=function(a,b,d){var e=c[d];if(e){var f=e.shift();0===e.length&&delete c[d];d=f}else d=null;d&&d(a,b)};this.onundefine=null;this.requestInputStream=function(a,f){if(f){var e=c[a];e||(e=[],c[a]=e);e.push(f)}b.requestObjectInputStream(d.index,a)};this.createOutputStream=function(a,c){return b.createObjectOutputStream(d.index,a,c)}};Guacamole.Object.ROOT_STREAM="/";
Guacamole.Object.STREAM_INDEX_MIMETYPE="application/vnd.glyptodon.guacamole.stream-index+json";Guacamole=Guacamole||{};
Guacamole.OnScreenKeyboard=function(b){var a=this,d={},c={},e=[],f=function(a,b){a.classList?a.classList.add(b):a.className+=" "+b},k=function(a,b){a.classList?a.classList.remove(b):a.className=a.className.replace(/([^ ]+)[ ]*/g,function(a,c){return c===b?"":a})},p=0,h=function(a,b,c,d){this.width=b;this.height=c;this.scale=function(e){a.style.width=b*e+"px";a.style.height=c*e+"px";d&&(a.style.lineHeight=c*e+"px",a.style.fontSize=e+"px")}},m=function(b){b=a.keys[b];if(!b)return null;for(var c=b.length-
1;0<=c;c--){var e=b[c];a:{var f=e.requires;for(var g=0;g<f.length;g++)if(!(f[g]in d)){f=!1;break a}f=!0}if(f)return e}return null},g=function(b,e){if(!c[b]){f(e,"guac-keyboard-pressed");e=m(b);if(e.modifier){var g="guac-keyboard-modifier-"+r(e.modifier),h=d[e.modifier];if(void 0===h){if(f(q,g),(d[e.modifier]=e.keysym)&&a.onkeydown)a.onkeydown(e.keysym)}else if(k(q,g),delete d[e.modifier],h&&a.onkeyup)a.onkeyup(h)}else if(a.onkeydown)a.onkeydown(e.keysym);c[b]=!0}},l=function(b,d){if(c[b]){k(d,"guac-keyboard-pressed");
d=m(b);if(!d.modifier&&a.onkeyup)a.onkeyup(d.keysym);c[b]=!1}},q=document.createElement("div");q.className="guac-keyboard";q.onselectstart=q.onmousemove=q.onmouseup=q.onmousedown=function(a){p&&p--;a.stopPropagation();return!1};this.touchMouseThreshold=3;this.onkeyup=this.onkeydown=null;this.layout=new Guacamole.OnScreenKeyboard.Layout(b);this.getElement=function(){return q};this.resize=function(b){b=Math.floor(10*b/a.layout.width)/10;for(var c=0;c<e.length;c++)e[c].scale(b)};this.keys=function(a){var c=
{},d;for(d in b.keys){var e=d;var f=d;var g=a[d];if(g instanceof Array){for(var h=[],p=0;p<g.length;p++)h.push(new Guacamole.OnScreenKeyboard.Key(g[p],f));f=h}else f="number"===typeof g?[new Guacamole.OnScreenKeyboard.Key({name:f,keysym:g})]:"string"===typeof g?[new Guacamole.OnScreenKeyboard.Key({name:f,title:g})]:[new Guacamole.OnScreenKeyboard.Key(g,f)];c[e]=f}return c}(b.keys);var r=function(a){return a.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[^A-Za-z0-9]+/g,"-").toLowerCase()};(function t(b,
c,d){var m,k=document.createElement("div");d&&f(k,"guac-keyboard-"+r(d));if(c instanceof Array)for(f(k,"guac-keyboard-group"),m=0;m<c.length;m++)t(k,c[m]);else if(c instanceof Object){f(k,"guac-keyboard-group");var q=Object.keys(c).sort();for(m=0;m<q.length;m++)d=q[m],t(k,c[d],d)}else if("number"===typeof c)f(k,"guac-keyboard-gap"),e.push(new h(k,c,c));else if("string"===typeof c){m=c;1===m.length&&(m="0x"+m.charCodeAt(0).toString(16));f(k,"guac-keyboard-key-container");var u=document.createElement("div");
u.className="guac-keyboard-key guac-keyboard-key-"+r(m);if(d=a.keys[c])for(m=0;m<d.length;m++){q=d[m];var n=document.createElement("div");n.className="guac-keyboard-cap";n.textContent=q.title;for(var w=0;w<q.requires.length;w++){var z=q.requires[w];f(n,"guac-keyboard-requires-"+r(z));f(u,"guac-keyboard-uses-"+r(z))}u.appendChild(n)}k.appendChild(u);e.push(new h(k,a.layout.keyWidths[c]||1,1,!0));m=function(a){a.preventDefault();0===p&&l(c,u)};u.addEventListener("touchstart",function(b){b.preventDefault();
p=a.touchMouseThreshold;g(c,u)},!0);u.addEventListener("touchend",function(b){b.preventDefault();p=a.touchMouseThreshold;l(c,u)},!0);u.addEventListener("mousedown",function(a){a.preventDefault();0===p&&g(c,u)},!0);u.addEventListener("mouseup",m,!0);u.addEventListener("mouseout",m,!0)}b.appendChild(k)})(q,b.layout)};Guacamole.OnScreenKeyboard.Layout=function(b){this.language=b.language;this.type=b.type;this.keys=b.keys;this.layout=b.layout;this.width=b.width;this.keyWidths=b.keyWidths||{}};
Guacamole.OnScreenKeyboard.Key=function(b,a){this.name=a||b.name;this.title=b.title||this.name;(a=b.keysym)||((a=this.title)&&1===a.length?(a=a.charCodeAt(0),a=0<=a&&255>=a?a:256<=a&&1114111>=a?16777216|a:null):a=null);this.keysym=a;this.modifier=b.modifier;this.requires=b.requires||[]};Guacamole=Guacamole||{};Guacamole.OutputStream=function(b,a){var d=this;this.index=a;this.onack=null;this.sendBlob=function(a){b.sendBlob(d.index,a)};this.sendEnd=function(){b.endStream(d.index)}};
Guacamole=Guacamole||{};
Guacamole.Parser=function(){var b=this,a="",d=[],c=-1,e=0,f=0;this.receive=function(k,p){p?a=k:(4096<e&&c>=e&&(a=a.substring(e),c-=e,e=0),a=a.length?a+k:k);for(;c<a.length;){if(c>=e){k=Guacamole.Parser.codePointCount(a,e,c);if(k<f){c+=f-k;continue}else if(f&&65536<=a.codePointAt(c-1)){c++;continue}k=a.substring(e,c);p=a.substring(c,c+1);d.push(k);if(";"===p){k=d.shift();if(null!==b.oninstruction)b.oninstruction(k,d);d=[];c+1===a.length&&(c=-1,a="")}else if(","!==p)throw Error('Element terminator of instruction was not ";" nor ",".');e=
c+1}k=a.indexOf(".",e);if(-1!==k){f=parseInt(a.substring(c+1,k));if(isNaN(f))throw Error("Non-numeric character in element length.");e=k+1;c=e+f}else{e=a.length;break}}};this.oninstruction=null};Guacamole.Parser.codePointCount=function(b,a,d){b=b.substring(a||0,d);a=b.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g);return b.length-(a?a.length:0)};
Guacamole.Parser.toInstruction=function(b){for(var a=function(a){a=""+a;return Guacamole.Parser.codePointCount(a)+"."+a},d=a(b[0]),c=1;c<b.length;c++)d+=","+a(b[c]);return d+";"};Guacamole=Guacamole||{};
Guacamole.Position=function(b){b=b||{};this.x=b.x||0;this.y=b.y||0;this.fromClientPosition=function(a,b,c){this.x=b-a.offsetLeft;this.y=c-a.offsetTop;for(a=a.offsetParent;a&&a!==document.body;)this.x-=a.offsetLeft-a.scrollLeft,this.y-=a.offsetTop-a.scrollTop,a=a.offsetParent;a&&(b=document.body.scrollTop||document.documentElement.scrollTop,this.x-=a.offsetLeft-(document.body.scrollLeft||document.documentElement.scrollLeft),this.y-=a.offsetTop-b)}};
Guacamole.Position.fromClientPosition=function(b,a,d){var c=new Guacamole.Position;c.fromClientPosition(b,a,d);return c};Guacamole=Guacamole||{};Guacamole.RawAudioFormat=function(b){this.bytesPerSample=b.bytesPerSample;this.channels=b.channels;this.rate=b.rate};
Guacamole.RawAudioFormat.parse=function(b){var a=null,d=1;if("audio/L8;"===b.substring(0,9)){b=b.substring(9);var c=1}else if("audio/L16;"===b.substring(0,10))b=b.substring(10),c=2;else return null;b=b.split(",");for(var e=0;e<b.length;e++){var f=b[e],k=f.indexOf("\x3d");if(-1===k)return null;var p=f.substring(0,k);f=f.substring(k+1);switch(p){case "channels":d=parseInt(f);break;case "rate":a=parseInt(f);break;default:return null}}return null===a?null:new Guacamole.RawAudioFormat({bytesPerSample:c,
channels:d,rate:a})};Guacamole=Guacamole||{};
Guacamole.SessionRecording=function(b,a){function d(a){B=new Guacamole.KeyEventInterpreter(null,a);B.onbatch=function(a){if(c.ontext)c.ontext(a)}}void 0===a&&(a=1E3);var c=this,e=null,f=[],k=0,p=new Guacamole.SessionRecording._PlaybackTunnel,h=new Guacamole.Client(p),m=-1,g=null,l=null,q=0,r=null,x=0,u=0,v=!1,y=null,t=null,A=null,E=function(a,b,d){if(!v||a!==z){var e=new Guacamole.Parser;e.oninstruction=b;var f=0,g=new FileReader;b=function(){if(!v||a!==z){if(2===g.readyState)try{e.receive(g.result)}catch(O){if(c.onerror)c.onerror(O.message);
return}if(f>=a.size)d&&d();else{var b=a.slice(f,f+262144);f+=b.size;g.readAsText(b)}}};g.onload=b;b()}},C=function(a){a=a.length;for(var b=a+3;10<=a;)b++,a=Math.floor(a/10);return b};h.connect();h.getDisplay().showCursor(!1);var B=null,n=function(a,b){u+=C(a);for(var e=0;e<b.length;e++)u+=C(b[e]);if("sync"===a){a=parseInt(b[0]);b=new Guacamole.SessionRecording._Frame(a,x,u);f.push(b);x=u;1===f.length&&d(a);if(1===f.length||16384<=u-f[k].start&&5E3<=a-f[k].timestamp)b.keyframe=!0,k=f.length-1;if(c.onprogress)c.onprogress(c.getDuration(),
u)}else"key"===a&&B.handleKeyEvent(b)},w=function(){if(c.onload)c.onload()};if(b instanceof Blob){var z=b;E(z,n,w)}else{e=b;z=new Blob;var F=!1,D="";e.oninstruction=function(a,b){D+=a.length+"."+a;b.forEach(function(a){D+=","+a.length+"."+a});D+=";";262144<=D.length&&(z=new Blob([z,D]),D="");n(a,b)};e.onerror=function(a){F=!0;if(c.onerror)c.onerror(a.message)};e.onstatechange=function(a){if(a===Guacamole.Tunnel.State.CLOSED){D.length&&(z=new Blob([z,D]),D="");if((a=B.getCurrentBatch())&&c.ontext)c.ontext(a);
F||w()}}}var H=function(a){return 0===f.length?0:a-f[0].timestamp},M=function L(a,b,c){if(a===b){if(0===a)return a;if(H(f[a].timestamp)>c)return a-1}var d=Math.floor((a+b)/2),e=H(f[d].timestamp);return c<e&&d>a?L(a,d-1,c):c>e&&d<b?L(d+1,b,c):d},N=function(a,b){var c=f[a];E(z.slice(c.start,c.end),function(a,b){p.receiveInstruction(a,b)},function(){c.keyframe&&!c.clientState&&h.exportState(function(a){c.clientState=new Blob([JSON.stringify(a)])});m=a;b&&b()})},J=function(a,b,d){G();for(var e=r={aborted:!1},
g=a,p=function P(){c.onseek&&m>g&&(q=H(f[m].timestamp),c.onseek(q,m-g,a-g));e.aborted||(m<a?N(m+1,P):b())},l=function(){var a=d?Math.max(d-(new Date).getTime(),0):0;a?(t&&clearTimeout(t),t=window.setTimeout(function(){t=null;p()},a)):p()};0<=g;g--){var k=f[g];if(g===m)break;if(k.clientState){k.clientState.text().then(function(a){h.importState(JSON.parse(a));m=g;l()});return}}l()},G=function(){r&&(r.aborted=!0,r=null)},I=function K(){if(c.isPlaying())if(m+1<f.length){var b=f[m+1],d=Date.now()-l;b=
H(b.timestamp)-g-d;var e=0<=a?a*Math.floor((q+a)/a)-q:b;b<=e?J(m+1,function(){A=Date.now();K()},Date.now()+b):(t&&window.clearTimeout(t),t=window.setTimeout(function(){t=null;q+=e;if(c.onseek)c.onseek(q);A=Date.now();K()},e))}else c.pause()};this.onseek=this.ontext=this.onpause=this.onplay=this.onprogress=this.onabort=this.onerror=this.onload=null;this.connect=function(a){e&&e.connect(a)};this.disconnect=function(){e&&e.disconnect()};this.abort=function(){if(!v){v=!0;if(c.onabort)c.onabort();e&&e.disconnect()}};
this.getDisplay=function(){return h.getDisplay()};this.isPlaying=function(){return!!l};this.getPosition=function(){return q};this.getDuration=function(){return 0===f.length?0:H(f[f.length-1].timestamp)};this.play=function(){if(!c.isPlaying()&&m+1<f.length){if(c.onplay)c.onplay();g=q;l=Date.now();A=Date.now();I()}};this.seek=function(a,b){if(0!==f.length){c.cancel();var d=c.isPlaying();c.pause();y=function(){y=null;d&&(c.play(),d=null);b&&b()};var e=M(0,f.length-1,a);J(e,function(){q=a;if(c.onseek)c.onseek(a);
y()})}};this.cancel=function(){y&&(G(),y())};this.pause=function(){G();t&&clearTimeout(t);q+=Date.now()-A;if(c.isPlaying()){if(c.onpause)c.onpause();l=g=A=null}}};Guacamole.SessionRecording._Frame=function(b,a,d){this.keyframe=!1;this.timestamp=b;this.start=a;this.end=d;this.clientState=null};
Guacamole.SessionRecording._PlaybackTunnel=function(){var b=this;this.connect=function(a){};this.sendMessage=function(a){};this.disconnect=function(){};this.receiveInstruction=function(a,d){if(b.oninstruction)b.oninstruction(a,d)}};Guacamole=Guacamole||{};Guacamole.Status=function(b,a){var d=this;this.code=b;this.message=a;this.isError=function(){return 0>d.code||255<d.code}};
Guacamole.Status.Code={SUCCESS:0,UNSUPPORTED:256,SERVER_ERROR:512,SERVER_BUSY:513,UPSTREAM_TIMEOUT:514,UPSTREAM_ERROR:515,RESOURCE_NOT_FOUND:516,RESOURCE_CONFLICT:517,RESOURCE_CLOSED:518,UPSTREAM_NOT_FOUND:519,UPSTREAM_UNAVAILABLE:520,SESSION_CONFLICT:521,SESSION_TIMEOUT:522,SESSION_CLOSED:523,CLIENT_BAD_REQUEST:768,CLIENT_UNAUTHORIZED:769,CLIENT_FORBIDDEN:771,CLIENT_TIMEOUT:776,CLIENT_OVERRUN:781,CLIENT_BAD_TYPE:783,CLIENT_TOO_MANY:797};
Guacamole.Status.Code.fromHTTPCode=function(b){switch(b){case 400:return Guacamole.Status.Code.CLIENT_BAD_REQUEST;case 403:return Guacamole.Status.Code.CLIENT_FORBIDDEN;case 404:return Guacamole.Status.Code.RESOURCE_NOT_FOUND;case 429:return Guacamole.Status.Code.CLIENT_TOO_MANY;case 503:return Guacamole.Status.Code.SERVER_BUSY}return Guacamole.Status.Code.SERVER_ERROR};
Guacamole.Status.Code.fromWebSocketCode=function(b){switch(b){case 1E3:return Guacamole.Status.Code.SUCCESS;case 1006:case 1015:return Guacamole.Status.Code.UPSTREAM_NOT_FOUND;case 1001:case 1012:case 1013:case 1014:return Guacamole.Status.Code.UPSTREAM_UNAVAILABLE}return Guacamole.Status.Code.SERVER_ERROR};Guacamole=Guacamole||{};
Guacamole.StringReader=function(b){var a=this,d=new Guacamole.UTF8Parser;b=new Guacamole.ArrayBufferReader(b);b.ondata=function(b){b=d.decode(b);if(a.ontext)a.ontext(b)};b.onend=function(){if(a.onend)a.onend()};this.onend=this.ontext=null};Guacamole=Guacamole||{};
Guacamole.StringWriter=function(b){function a(b){if(127>=b){var c=0;var d=1}else if(2047>=b)c=192,d=2;else if(65535>=b)c=224,d=3;else if(2097151>=b)c=240,d=4;else{a(65533);return}var e=d;if(k+e>=f.length){var p=new Uint8Array(2*(k+e));p.set(f);f=p}k+=e;e=k-1;for(p=1;p<d;p++)f[e--]=128|b&63,b>>=6;f[e]=c|b}function d(b){for(var c=0;c<b.length;c++){var d=b.charCodeAt(c);a(d)}if(0<k)return b=f.subarray(0,k),k=0,b}var c=this,e=new Guacamole.ArrayBufferWriter(b),f=new Uint8Array(8192),k=0;e.onack=function(a){if(c.onack)c.onack(a)};
this.sendText=function(a){a.length&&e.sendData(d(a))};this.sendEnd=function(){e.sendEnd()};this.onack=null};Guacamole=Guacamole||{};
Guacamole.Touch=function(b){Guacamole.Event.Target.call(this);var a=this,d=Math.floor(16*window.devicePixelRatio);this.touches={};this.activeTouches=0;b.addEventListener("touchstart",function(c){for(var e=0;e<c.changedTouches.length;e++){var f=c.changedTouches[e],k=f.identifier;a.touches[k]||(k=a.touches[k]=new Guacamole.Touch.State({id:k,radiusX:f.radiusX||d,radiusY:f.radiusY||d,angle:f.angle||0,force:f.force||1}),a.activeTouches++,k.fromClientPosition(b,f.clientX,f.clientY),a.dispatch(new Guacamole.Touch.Event("touchmove",
c,k)))}},!1);b.addEventListener("touchmove",function(c){for(var e=0;e<c.changedTouches.length;e++){var f=c.changedTouches[e],k=a.touches[f.identifier];k&&(f.force&&(k.force=f.force),k.angle=f.angle||0,k.radiusX=f.radiusX||d,k.radiusY=f.radiusY||d,k.fromClientPosition(b,f.clientX,f.clientY),a.dispatch(new Guacamole.Touch.Event("touchmove",c,k)))}},!1);b.addEventListener("touchend",function(c){for(var d=0;d<c.changedTouches.length;d++){var f=c.changedTouches[d],k=f.identifier,p=a.touches[k];p&&(delete a.touches[k],
a.activeTouches--,p.force=0,p.fromClientPosition(b,f.clientX,f.clientY),a.dispatch(new Guacamole.Touch.Event("touchend",c,p)))}},!1)};Guacamole.Touch.State=function(b){b=b||{};Guacamole.Position.call(this,b);this.id=b.id||0;this.radiusX=b.radiusX||0;this.radiusY=b.radiusY||0;this.angle=b.angle||0;this.force=b.force||1};Guacamole.Touch.Event=function(b,a,d){Guacamole.Event.DOMEvent.call(this,b,[a]);this.state=d};Guacamole=Guacamole||{};
Guacamole.Tunnel=function(){this.connect=function(b){};this.disconnect=function(){};this.sendMessage=function(b){};this.setState=function(b){if(b!==this.state&&(this.state=b,this.onstatechange))this.onstatechange(b)};this.setUUID=function(b){this.uuid=b;if(this.onuuid)this.onuuid(b)};this.isConnected=function(){return this.state===Guacamole.Tunnel.State.OPEN||this.state===Guacamole.Tunnel.State.UNSTABLE};this.state=Guacamole.Tunnel.State.CLOSED;this.receiveTimeout=15E3;this.unstableThreshold=1500;
this.oninstruction=this.onstatechange=this.onerror=this.onuuid=this.uuid=null};Guacamole.Tunnel.INTERNAL_DATA_OPCODE="";Guacamole.Tunnel.State={CONNECTING:0,OPEN:1,CLOSED:2,UNSTABLE:3};
Guacamole.HTTPTunnel=function(b,a,d){function c(a,b){for(var c in b)a.setRequestHeader(c,b[c])}function e(a){window.clearTimeout(y);window.clearTimeout(t);window.clearInterval(A);if(m.state!==Guacamole.Tunnel.State.CLOSED){if(a.code!==Guacamole.Status.Code.SUCCESS&&m.onerror&&(m.state===Guacamole.Tunnel.State.CONNECTING||a.code!==Guacamole.Status.Code.RESOURCE_NOT_FOUND))m.onerror(a);x=!1;m.setState(Guacamole.Tunnel.State.CLOSED)}}function f(){if(m.isConnected())if(0<u.length){x=!0;var a=new XMLHttpRequest;
a.open("POST",q+m.uuid);a.withCredentials=v;c(a,E);a.setRequestHeader("Content-type","application/octet-stream");a.setRequestHeader("Guacamole-Tunnel-Token",C);a.onreadystatechange=function(){4===a.readyState&&(B(),200!==a.status?k(a):f())};a.send(u);u=""}else x=!1}function k(a){var b=parseInt(a.getResponseHeader("Guacamole-Status-Code"));b?(a=a.getResponseHeader("Guacamole-Error-Message"),e(new Guacamole.Status(b,a))):a.status?e(new Guacamole.Status(Guacamole.Status.Code.fromHTTPCode(a.status),a.statusText)):
e(new Guacamole.Status(Guacamole.Status.Code.UPSTREAM_NOT_FOUND))}function p(a){function b(){if(!m.isConnected())null!==c&&clearInterval(c);else if(!(2>a.readyState)){try{var f=a.status}catch(G){f=200}d||200!==f||(d=h());if(3===a.readyState||4===a.readyState)if(B(),1===r&&(3!==a.readyState||c?4===a.readyState&&c&&clearInterval(c):c=setInterval(b,30)),0===a.status)m.disconnect();else if(200!==a.status)k(a);else{try{var p=a.responseText}catch(G){return}try{g.receive(p,!0)}catch(G){e(new Guacamole.Status(Guacamole.Status.Code.SERVER_ERROR,
G.message))}}}}var c=null,d=null,f=0,g=new Guacamole.Parser;g.oninstruction=function I(b,e){if(b===Guacamole.Tunnel.INTERNAL_DATA_OPCODE&&0===e.length)g=new Guacamole.Parser,g.oninstruction=I,c&&clearInterval(c),a.onreadystatechange=null,a.abort(),d&&p(d);else if(b!==Guacamole.Tunnel.INTERNAL_DATA_OPCODE&&m.oninstruction)m.oninstruction(b,e)};a.onreadystatechange=1===r?function(){3===a.readyState&&(f++,2<=f&&(r=0,a.onreadystatechange=b));b()}:b;b()}function h(){var a=new XMLHttpRequest;a.open("GET",
l+m.uuid+":"+n++);a.setRequestHeader("Guacamole-Tunnel-Token",C);a.withCredentials=v;c(a,E);a.send(null);return a}var m=this,g=b+"?connect",l=b+"?read:",q=b+"?write:",r=1,x=!1,u="",v=!!a,y=null,t=null,A=null,E=d||{},C=null,B=function(){window.clearTimeout(y);window.clearTimeout(t);m.state===Guacamole.Tunnel.State.UNSTABLE&&m.setState(Guacamole.Tunnel.State.OPEN);y=window.setTimeout(function(){e(new Guacamole.Status(Guacamole.Status.Code.UPSTREAM_TIMEOUT,"Server timeout."))},m.receiveTimeout);t=window.setTimeout(function(){m.setState(Guacamole.Tunnel.State.UNSTABLE)},
m.unstableThreshold)};this.sendMessage=function(){m.isConnected()&&arguments.length&&(u+=Guacamole.Parser.toInstruction(arguments),x||f())};var n=0;this.connect=function(a){B();m.setState(Guacamole.Tunnel.State.CONNECTING);var b=new XMLHttpRequest;b.onreadystatechange=function(){4===b.readyState&&(200!==b.status?k(b):(B(),m.setUUID(b.responseText),(C=b.getResponseHeader("Guacamole-Tunnel-Token"))?(m.setState(Guacamole.Tunnel.State.OPEN),A=setInterval(function(){m.sendMessage("nop")},500),p(h())):
e(new Guacamole.Status(Guacamole.Status.Code.UPSTREAM_NOT_FOUND))))};b.open("POST",g,!0);b.withCredentials=v;c(b,E);b.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset\x3dUTF-8");b.send(a)};this.disconnect=function(){e(new Guacamole.Status(Guacamole.Status.Code.SUCCESS,"Manually closed."))}};Guacamole.HTTPTunnel.prototype=new Guacamole.Tunnel;
Guacamole.WebSocketTunnel=function(b){function a(a){window.clearTimeout(f);window.clearTimeout(k);window.clearTimeout(p);if(d.state!==Guacamole.Tunnel.State.CLOSED){if(a.code!==Guacamole.Status.Code.SUCCESS&&d.onerror)d.onerror(a);d.setState(Guacamole.Tunnel.State.CLOSED);e.close()}}var d=this,c=null,e=null,f=null,k=null,p=null,h={"http:":"ws:","https:":"wss:"},m=0;if("ws:"!==b.substring(0,3)&&"wss:"!==b.substring(0,4))if(h=h[window.location.protocol],"/"===b.substring(0,1))b=h+"//"+window.location.host+
b;else{var g=window.location.pathname.lastIndexOf("/");g=window.location.pathname.substring(0,g+1);b=h+"//"+window.location.host+g+b}var l=function(){var a=(new Date).getTime();d.sendMessage(Guacamole.Tunnel.INTERNAL_DATA_OPCODE,"ping",a);m=a},q=function(){window.clearTimeout(f);window.clearTimeout(k);window.clearTimeout(p);d.state===Guacamole.Tunnel.State.UNSTABLE&&d.setState(Guacamole.Tunnel.State.OPEN);f=window.setTimeout(function(){a(new Guacamole.Status(Guacamole.Status.Code.UPSTREAM_TIMEOUT,
"Server timeout."))},d.receiveTimeout);k=window.setTimeout(function(){d.setState(Guacamole.Tunnel.State.UNSTABLE)},d.unstableThreshold);var b=(new Date).getTime();b=Math.max(m+500-b,0);0<b?p=window.setTimeout(l,b):l()};this.sendMessage=function(a){d.isConnected()&&arguments.length&&e.send(Guacamole.Parser.toInstruction(arguments))};this.connect=function(f){q();d.setState(Guacamole.Tunnel.State.CONNECTING);c=new Guacamole.Parser;c.oninstruction=function(a,b){null===d.uuid&&(a===Guacamole.Tunnel.INTERNAL_DATA_OPCODE&&
1===b.length&&d.setUUID(b[0]),d.setState(Guacamole.Tunnel.State.OPEN));if(a!==Guacamole.Tunnel.INTERNAL_DATA_OPCODE&&d.oninstruction)d.oninstruction(a,b)};e=new WebSocket(b+"?"+f,"guacamole");e.onopen=function(a){q()};e.onclose=function(b){b.reason?a(new Guacamole.Status(parseInt(b.reason),b.reason)):b.code?a(new Guacamole.Status(Guacamole.Status.Code.fromWebSocketCode(b.code))):a(new Guacamole.Status(Guacamole.Status.Code.UPSTREAM_NOT_FOUND))};e.onmessage=function(b){q();try{c.receive(b.data)}catch(u){a(new Guacamole.Status(Guacamole.Status.Code.SERVER_ERROR,
u.message))}}};this.disconnect=function(){a(new Guacamole.Status(Guacamole.Status.Code.SUCCESS,"Manually closed."))}};Guacamole.WebSocketTunnel.prototype=new Guacamole.Tunnel;
Guacamole.ChainedTunnel=function(b){function a(b){function h(){b.onstatechange=d.onstatechange;b.oninstruction=d.oninstruction;b.onerror=d.onerror;b.uuid&&d.setUUID(b.uuid);b.onuuid=function(a){d.setUUID(a)};f=b}d.disconnect=b.disconnect;d.sendMessage=b.sendMessage;var k=function(c){if(c&&c.code===Guacamole.Status.Code.UPSTREAM_TIMEOUT)return e=[],null;if(c=e.shift())b.onerror=null,b.oninstruction=null,b.onstatechange=null,a(c);return c};b.onstatechange=function(a){switch(a){case Guacamole.Tunnel.State.OPEN:h();
if(d.onstatechange)d.onstatechange(a);break;case Guacamole.Tunnel.State.CLOSED:if(!k()&&d.onstatechange)d.onstatechange(a)}};b.oninstruction=function(a,b){h();if(d.oninstruction)d.oninstruction(a,b)};b.onerror=function(a){if(!k(a)&&d.onerror)d.onerror(a)};b.connect(c)}for(var d=this,c,e=[],f=null,k=0;k<arguments.length;k++)e.push(arguments[k]);this.connect=function(b){c=b;if(b=f?f:e.shift())a(b);else if(d.onerror)d.onerror(Guacamole.Status.Code.SERVER_ERROR,"No tunnels to try.")}};
Guacamole.ChainedTunnel.prototype=new Guacamole.Tunnel;
Guacamole.StaticHTTPTunnel=function(b,a,d){var c=this,e=null,f=d||{};this.size=null;this.sendMessage=function(a){};this.connect=function(d){c.disconnect();c.setState(Guacamole.Tunnel.State.CONNECTING);var k=new Guacamole.Parser,h=new Guacamole.UTF8Parser;k.oninstruction=function(a,b){if(c.oninstruction)c.oninstruction(a,b)};e=new AbortController;fetch(b,{headers:f,credentials:a?"include":"same-origin",signal:e.signal}).then(function(a){if(a.ok){c.size=a.headers.get("Content-Length");c.setState(Guacamole.Tunnel.State.OPEN);
var b=a.body.getReader();b.read().then(function r(a){a.done?c.disconnect():(k.receive(h.decode(a.value)),b.read().then(r))})}else{if(c.onerror)c.onerror(new Guacamole.Status(Guacamole.Status.Code.fromHTTPCode(a.status),a.statusText));c.disconnect()}})};this.disconnect=function(){e&&(e.abort(),e=null);c.setState(Guacamole.Tunnel.State.CLOSED)}};Guacamole.StaticHTTPTunnel.prototype=new Guacamole.Tunnel;Guacamole=Guacamole||{};
Guacamole.UTF8Parser=function(){var b=0,a=0;this.decode=function(d){var c="";d=new Uint8Array(d);for(var e=0;e<d.length;e++){var f=d[e];0===b?127===(f|127)?c+=String.fromCharCode(f):223===(f|31)?(a=f&31,b=1):239===(f|15)?(a=f&15,b=2):247===(f|7)?(a=f&7,b=3):c+="":191===(f|63)?(a=a<<6|f&63,b--,0===b&&(c+=String.fromCharCode(a))):(b=0,c+="")}return c}};Guacamole=Guacamole||{};Guacamole.API_VERSION="1.5.3";Guacamole=Guacamole||{};Guacamole.VideoPlayer=function(){this.sync=function(){}};
Guacamole.VideoPlayer.isSupportedType=function(b){return!1};Guacamole.VideoPlayer.getSupportedTypes=function(){return[]};Guacamole.VideoPlayer.getInstance=function(b,a,d){return null};